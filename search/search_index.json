{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"ganon :) GitHub repository ganon is designed to index large sets of genomic reference sequences and to classify reads against them efficiently. The tool uses Interleaved Bloom Filters as indices based on k-mers/minimizers. It was mainly developed, but not limited, to the metagenomics classification problem: quickly assign sequence fragments to their closest reference among thousands of references. After classification, taxonomic abundance is estimated and reported. Features :) NCBI and GTDB native support for taxonomic classification (also runs without taxonomy) integrated download of commonly used reference sequences from RefSeq/Genbank ( ganon build ) update indices incrementally ( ganon update ) customizable build for pre-downloaded or non-standard sequence files ( ganon build-custom ) build and classify at different taxonomic levels, file, sequence, strain/assembly or custom specialization perform hierarchical classification : use several databases in any order report the lowest common ancestor (LCA) but also multiple and unique matches for every read report sequence or taxonomic abundances as well as total number of matches reassignment of reads with multiple matches to a unique match with an EM algorithm generate reports and contingency tables for multi-sample studies with several filter options ganon achieved very good results in our own evaluations but also in independent evaluations: LEMMI , LEMMI v2 and CAMI2 Installation with conda :) The easiest way to install ganon is via conda, using the bioconda and conda-forge channels: conda install -c bioconda -c conda-forge ganon However, there are possible performance benefits compiling ganon from source in the target machine rather than using the conda version. To do so, please follow the instructions below: Installation from source :) Dependencies :) gcc >=7 cmake >=3.10 zlib python >=3.6 pandas >=1.1.0 multitax >=1.3.1 python3 -V # >=3.6 python3 -m pip install \"pandas>=1.1.0\" \"multitax>=1.3.1\" Downloading and building ganon + submodules :) git clone --recurse-submodules https://github.com/pirovc/ganon.git cd ganon python3 setup.py install --record files.txt # optional mkdir build_cpp cd build_cpp cmake -DCMAKE_BUILD_TYPE=Release -DVERBOSE_CONFIG=ON -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DCONDA=OFF -DLONGREADS=OFF .. make sudo make install # optional to change install location (e.g. /myprefix/bin/ ), set the installation prefix in the cmake command with -DCMAKE_INSTALL_PREFIX=/myprefix/ use -DINCLUDE_DIRS to set alternative paths to cxxopts and Catch2 libs. to classify extremely large reads (>65000bp) use -DLONGREADS=\u00d2N If everything was properly installed, the following commands should show the help pages without errors: ganon -h Running tests :) python3 -m unittest discover -s tests/ganon/integration/ python3 -m unittest discover -s tests/ganon/integration_online/ # optional - downloads large files cd build_cpp/ ctest -VV . Important parameters :) The most important parameters and trade-offs are: ganon build --hibf : build smaller databases that can be queried faster. Building will take longer. ganon build --window-size --kmer-size : the window value should always be the same or larger than the kmer value. The larger the difference between them, the smaller the database will be. However, some sensitivity/precision loss in classification is expected with small kmer and/or large window . Larger kmer values (e.g. 31 ) will improve classification, specially read binning, at a cost of way bigger databases. ganon classify --rel-cutoff : this value defines the threshold for matches between reads and database. Higher --rel-cutoff values will improve precision and decrease sensitivity with expected less unique matches but an increase in overall matches. For taxonomic profiling, a higher value between 0.4 and 0.8 may provide better results. For read binning, lower values between 0.2 and 0.4 are recommended. ganon classify --rel-filter : further filter top matches after cutoff is applied. Usually set between 0 and 0.2 . ganon classify --reassign : runs an EM-algorithm to reassign reads that received multiple matches. It provides a unique match for each read at the level the database was built (e.g. assembly or species). Mostly useful for read binning, with little overall impact on taxonomic profiling. Can be used independently with ganon reassign . ganon report --report-type : reports either taxonomic, sequence or matches abundances. Use corr or abundance for taxonomic profiling, reads or dist for sequence profiling and matches to report a summary of all matches. ganon report --min-count : cutoff to discard underrepresented taxa. Useful to remove the common long tail of spurious matches and false positives when performing classification. Values between 0.0001 (0.01%) and 0.001 (0.1%) improved sensitivity and precision in our evaluations. The higher the value, the more precise the outcome, with a sensitivity loss. Alternatively --top-percentile can be used to keep a relative amount of taxa instead a hard cutoff. The numeric values above are averages from several experiments with different sample types and database contents. They may not work as expected for your data. If you are not sure which values to use or see something unexpected, please open an issue . Parameters :) usage: ganon [-h] [-v] {build,build-custom,update,classify,reassign,report,table} ... - - - - - - - - - - _ _ _ _ _ (_|(_|| |(_)| | _| v. 1.6.0 - - - - - - - - - - positional arguments: {build,build-custom,update,classify,reassign,report,table} build Download and build ganon default databases (refseq/genbank) build-custom Build custom ganon databases update Update ganon default databases classify Classify reads against built databases reassign Reassign reads with multiple matches with an EM algorithm report Generate reports from classification results table Generate table from reports options: -h, --help show this help message and exit -v, --version Show program's version number and exit. ganon build usage: ganon build [-h] [-g [...]] [-a [...]] [-b [...]] [-o] [-c] [-u] [-m [...]] [-z [...]] -d DB_PREFIX [-x] [-t] [-p] [-f] [-k] [-w] [-s] [-j] [-y] [--hibf] [--restart] [--verbose] [--quiet] [--write-info-file] options: -h, --help show this help message and exit required arguments: -g [ ...], --organism-group [ ...] One or more organism groups to download [archaea, bacteria, fungi, human, invertebrate, metagenomes, other, plant, protozoa, vertebrate_mammalian, vertebrate_other, viral]. Mutually exclusive --taxid (default: None) -a [ ...], --taxid [ ...] One or more taxonomic identifiers to download. e.g. 562 (-x ncbi) or 's__Escherichia coli' (-x gtdb). Mutually exclusive --organism-group (default: None) -d DB_PREFIX, --db-prefix DB_PREFIX Database output prefix (default: None) download arguments: -b [ ...], --source [ ...] Source to download [refseq, genbank] (default: ['refseq']) -o , --top Download limited assemblies for each taxa. 0 for all. (default: 0) -c, --complete-genomes Download only sub-set of complete genomes (default: False) -u , --genome-updater Additional genome_updater parameters (https://github.com/pirovc/genome_updater) (default: None) -m [ ...], --taxonomy-files [ ...] Specific files for taxonomy - otherwise files will be downloaded (default: None) -z [ ...], --genome-size-files [ ...] Specific files for genome size estimation - otherwise files will be downloaded (default: None) important arguments: -x , --taxonomy Set taxonomy to enable taxonomic classification, lca and reports [ncbi, gtdb, skip] (default: ncbi) -t , --threads advanced arguments: -p , --max-fp Max. false positive rate for bloom filters Mutually exclusive --filter-size. (default: 0.05) -f , --filter-size Fixed size for filter in Megabytes (MB). Mutually exclusive --max-fp. (default: 0) -k , --kmer-size The k-mer size to split sequences. (default: 19) -w , --window-size The window-size to build filter with minimizers. (default: 31) -s , --hash-functions The number of hash functions for the interleaved bloom filter [0-5]. 0 to detect optimal value. (default: 4) -j , --mode Create smaller or faster filters at the cost of classification speed or database size, respectively [avg, smaller, smallest, faster, fastest]. If --filter-size is used, smaller/smallest refers to the false positive rate. By default, an average value is calculated to balance classification speed and database size. (default: avg) -y , --min-length Skip sequences smaller then value defined. 0 to not skip any sequence. (default: 0) --hibf Builds an HIBF with raptor/chopper (v3). --mode, --filter-size and --min-length will be ignored. (default: False) optional arguments: --restart Restart build/update from scratch, do not try to resume from the latest possible step. {db_prefix}_files/ will be deleted if present. (default: False) --verbose Verbose output mode (default: False) --quiet Quiet output mode (default: False) --write-info-file Save copy of target info generated to {db_prefix}.info.tsv. Can be re-used as --input-file for further attempts. (default: False) ganon build-custom usage: ganon build-custom [-h] [-i [...]] [-e] [-c] [-n] [-a] [-l] [-m [...]] [-z [...]] [-r [...]] [-q [...]] -d DB_PREFIX [-x] [-t] [-p] [-f] [-k] [-w] [-s] [-j] [-y] [--hibf] [--restart] [--verbose] [--quiet] [--write-info-file] options: -h, --help show this help message and exit required arguments: -i [ ...], --input [ ...] Input file(s) and/or folder(s). Mutually exclusive --input-file. (default: None) -e , --input-extension Required if --input contains folder(s). Wildcards/Shell Expansions not supported (e.g. *). (default: fna.gz) -c, --input-recursive Look for files recursively in folder(s) provided with --input (default: False) -d DB_PREFIX, --db-prefix DB_PREFIX Database output prefix (default: None) custom arguments: -n , --input-file Manually set information for input files: file <tab> [target <tab> node <tab> specialization <tab> specialization name]. target is the sequence identifier if --input-target sequence (file can be repeated for multiple sequences). if --input-target file and target is not set, filename is used. node is the taxonomic identifier. Mutually exclusive --input (default: None) -a , --input-target Target to use [file, sequence]. By default: 'file' if multiple input files are provided or --input-file is set, 'sequence' if a single file is provided. Using 'file' is recommended and will speed-up the building process (default: None) -l , --level Use a specialized target to build the database. By default, --level is the --input-target. Options: any available taxonomic rank [species, genus, ...] or 'leaves' (requires --taxonomy). Further specialization options [assembly, custom]. assembly will retrieve and use the assembly accession and name. custom requires and uses the specialization field in the --input-file. (default: None) -m [ ...], --taxonomy-files [ ...] Specific files for taxonomy - otherwise files will be downloaded (default: None) -z [ ...], --genome-size-files [ ...] Specific files for genome size estimation - otherwise files will be downloaded (default: None) ncbi arguments: -r [ ...], --ncbi-sequence-info [ ...] Uses NCBI e-utils webservices or downloads accession2taxid files to extract target information. [eutils, nucl_gb, nucl_wgs, nucl_est, nucl_gss, pdb, prot, dead_nucl, dead_wgs, dead_prot or one or more accession2taxid files from https://ftp.ncbi.nlm.nih.gov/pub/taxonomy/accession2taxid/]. By default uses e-utils up-to 50000 sequences or downloads nucl_gb nucl_wgs otherwise. (default: []) -q [ ...], --ncbi-file-info [ ...] Downloads assembly_summary files to extract target information. [refseq, genbank, refseq_historical, genbank_historical or one or more assembly_summary files from https://ftp.ncbi.nlm.nih.gov/genomes/] (default: ['refseq', 'genbank']) important arguments: -x , --taxonomy Set taxonomy to enable taxonomic classification, lca and reports [ncbi, gtdb, skip] (default: ncbi) -t , --threads advanced arguments: -p , --max-fp Max. false positive rate for bloom filters Mutually exclusive --filter-size. (default: 0.05) -f , --filter-size Fixed size for filter in Megabytes (MB). Mutually exclusive --max-fp. (default: 0) -k , --kmer-size The k-mer size to split sequences. (default: 19) -w , --window-size The window-size to build filter with minimizers. (default: 31) -s , --hash-functions The number of hash functions for the interleaved bloom filter [0-5]. 0 to detect optimal value. (default: 4) -j , --mode Create smaller or faster filters at the cost of classification speed or database size, respectively [avg, smaller, smallest, faster, fastest]. If --filter-size is used, smaller/smallest refers to the false positive rate. By default, an average value is calculated to balance classification speed and database size. (default: avg) -y , --min-length Skip sequences smaller then value defined. 0 to not skip any sequence. (default: 0) --hibf Builds an HIBF with raptor/chopper (v3). --mode, --filter-size and --min-length will be ignored. (default: False) optional arguments: --restart Restart build/update from scratch, do not try to resume from the latest possible step. {db_prefix}_files/ will be deleted if present. (default: False) --verbose Verbose output mode (default: False) --quiet Quiet output mode (default: False) --write-info-file Save copy of target info generated to {db_prefix}.info.tsv. Can be re-used as --input-file for further attempts. (default: False) ganon update usage: ganon update [-h] -d DB_PREFIX [-o] [-t] [--restart] [--verbose] [--quiet] [--write-info-file] options: -h, --help show this help message and exit required arguments: -d DB_PREFIX, --db-prefix DB_PREFIX Existing database input prefix (default: None) important arguments: -o , --output-db-prefix Output database prefix. By default will be the same as --db-prefix and overwrite files (default: None) -t , --threads optional arguments: --restart Restart build/update from scratch, do not try to resume from the latest possible step. {db_prefix}_files/ will be deleted if present. (default: False) --verbose Verbose output mode (default: False) --quiet Quiet output mode (default: False) --write-info-file Save copy of target info generated to {db_prefix}.info.tsv. Can be re-used as --input-file for further attempts. (default: False) ganon classify usage: ganon classify [-h] -d [DB_PREFIX ...] [-s [reads.fq[.gz] ...]] [-p [reads.1.fq[.gz] reads.2.fq[.gz] ...]] [-c [...]] [-e [...]] [-o] [--output-lca] [--output-all] [--output-unclassified] [--output-single] [-t] [-l [...]] [-r [...]] [-a] [--verbose] [--quiet] options: -h, --help show this help message and exit required arguments: -d [DB_PREFIX ...], --db-prefix [DB_PREFIX ...] Database input prefix[es] (default: None) -s [reads.fq[.gz] ...], --single-reads [reads.fq[.gz] ...] Multi-fastq[.gz] file[s] to classify (default: None) -p [reads.1.fq[.gz] reads.2.fq[.gz] ...], --paired-reads [reads.1.fq[.gz] reads.2.fq[.gz] ...] Multi-fastq[.gz] pairs of file[s] to classify (default: None) cutoff/filter arguments: -c [ ...], --rel-cutoff [ ...] Min. percentage of a read (set of minimizers) shared with the a reference necessary to consider a match. Generally used to cutoff low similarity matches. Single value or one per database (e.g. 0.7 1 0.25). 0 for no cutoff (default: [0.75]) -e [ ...], --rel-filter [ ...] Additional relative percentage of minimizers (relative to the best match) to keep a match. Generally used to select best matches above cutoff. Single value or one per hierarchy (e.g. 0.1 0). 1 for no filter (default: [0.0]) output arguments: -o , --output-prefix Output prefix for output (.rep) and report (.tre). Empty to output to STDOUT (only .rep) (default: None) --output-lca Output an additional file with one lca match for each read (.lca) (default: False) --output-all Output an additional file with all matches. File can be very large (.all) (default: False) --output-unclassified Output an additional file with unclassified read headers (.unc) (default: False) --output-single When using multiple hierarchical levels, output everything in one file instead of one per hierarchy (default: False) other arguments: -t , --threads Number of sub-processes/threads to use (default: 1) -l [ ...], --hierarchy-labels [ ...] Hierarchy definition of --db-prefix files to be classified. Can also be a string, but input will be sorted to define order (e.g. 1 1 2 3). The default value reported without hierarchy is 'H1' (default: None) -r [ ...], --ranks [ ...] Ranks to report taxonomic abundances (.tre). empty will report default ranks [superkingdom, phylum, class, order, family, genus, species, assembly]. This file can be re-generated with the 'ganon report' command for other types of abundances (reads, matches) with further filtration and output options (default: []) -a, --reassign Reassign reads with multiple matches with an EM algorithm. Will enforce --output-all. This file can be re-generated with the 'ganon reassign'. (default: False) --verbose Verbose output mode (default: False) --quiet Quiet output mode (default: False) ganon reassign usage: ganon reassign [-h] -i -o OUTPUT_PREFIX [-e] [-s] [--verbose] [--quiet] options: -h, --help show this help message and exit required arguments: -i , --input-prefix Input prefix to find files from ganon classify (.all and optionally .rep) (default: None) -o OUTPUT_PREFIX, --output-prefix OUTPUT_PREFIX Output prefix for reassigned file (.all and optionally .rep). In case of multiple files, the base input filename will be appended at the end of the output file 'output_prefix + FILENAME.all' (default: None) EM arguments: -e , --max-iter Max. number of iterations for the EM algorithm. If 0, will run until convergence (check --threshold) (default: 10) -s , --threshold Convergence threshold limit to stop the EM algorithm. (default: 0) other arguments: --verbose Verbose output mode (default: False) --quiet Quiet output mode (default: False) ganon report usage: ganon report [-h] -i [...] [-e INPUT_EXTENSION] -o OUTPUT_PREFIX [-d [...]] [-x] [-m [...]] [-z [...]] [-f] [-t] [-r [...]] [-s] [-a] [-y] [-p [...]] [-k [...]] [-c] [--verbose] [--quiet] [--min-count] [--max-count] [--names [...]] [--names-with [...]] [--taxids [...]] options: -h, --help show this help message and exit required arguments: -i [ ...], --input [ ...] Input file(s) and/or folder(s). '.rep' file(s) from ganon classify. (default: None) -e INPUT_EXTENSION, --input-extension INPUT_EXTENSION Required if --input contains folder(s). Wildcards/Shell Expansions not supported (e.g. *). (default: rep) -o OUTPUT_PREFIX, --output-prefix OUTPUT_PREFIX Output prefix for report file 'output_prefix.tre'. In case of multiple files, the base input filename will be appended at the end of the output file 'output_prefix + FILENAME.tre' (default: None) db/tax arguments: -d [ ...], --db-prefix [ ...] Database prefix(es) used for classification. Only '.tax' file(s) are required. If not provided, new taxonomy will be downloaded. Mutually exclusive with --taxonomy. (default: []) -x , --taxonomy Taxonomy database to use [ncbi, gtdb, skip]. Mutually exclusive with --db-prefix. (default: ncbi) -m [ ...], --taxonomy-files [ ...] Specific files for taxonomy - otherwise files will be downloaded (default: None) -z [ ...], --genome-size-files [ ...] Specific files for genome size estimation - otherwise files will be downloaded (default: None) output arguments: -f , --output-format Output format [text, tsv, csv, bioboxes]. text outputs a tabulated formatted text file for better visualization. bioboxes is the the CAMI challenge profiling format (only percentage/abundances are reported). (default: tsv) -t , --report-type Type of report [abundance, reads, matches, dist, corr]. 'abundance' -> tax. abundance (re- distribute read counts and correct by genome size), 'reads' -> sequence abundance, 'matches' -> report all unique and shared matches, 'dist' -> like reads with re-distribution of shared read counts only, 'corr' -> like abundance without re-distribution of shared read counts (default: abundance) -r [ ...], --ranks [ ...] Ranks to report ['', 'all', custom list]. 'all' for all possible ranks. empty for default ranks [superkingdom, phylum, class, order, family, genus, species, assembly]. (default: []) -s , --sort Sort report by [rank, lineage, count, unique]. Default: rank (with custom --ranks) or lineage (with --ranks all) (default: ) -a, --no-orphan Omit orphan nodes from the final report. Otherwise, orphan nodes (= nodes not found in the db/tax) are reported as 'na' with root as direct parent. (default: False) -y, --split-hierarchy Split output reports by hierarchy (from ganon classify --hierarchy-labels). If activated, the output files will be named as '{output_prefix}.{hierarchy}.tre' (default: False) -p [ ...], --skip-hierarchy [ ...] One or more hierarchies to skip in the report (from ganon classify --hierarchy-labels) (default: []) -k [ ...], --keep-hierarchy [ ...] One or more hierarchies to keep in the report (from ganon classify --hierarchy-labels) (default: []) -c , --top-percentile Top percentile filter, based on percentage/relative abundance. Applied only at default ranks [superkingdom, phylum, class, order, family, genus, species, assembly] (default: 0) optional arguments: --verbose Verbose output mode (default: False) --quiet Quiet output mode (default: False) filter arguments: --min-count Minimum number/percentage of counts to keep an taxa [values between 0-1 for percentage, >1 specific number] (default: 0) --max-count Maximum number/percentage of counts to keep an taxa [values between 0-1 for percentage, >1 specific number] (default: 0) --names [ ...] Show only entries matching exact names of the provided list (default: []) --names-with [ ...] Show entries containing full or partial names of the provided list (default: []) --taxids [ ...] One or more taxids to report (including children taxa) (default: []) ganon table usage: ganon table [-h] -i [...] [-e] -o OUTPUT_FILE [-l] [-f] [-t] [-a] [-m] [-r] [-n] [--header] [--unclassified-label] [--filtered-label] [--skip-zeros] [--transpose] [--verbose] [--quiet] [--min-count] [--max-count] [--names [...]] [--names-with [...]] [--taxids [...]] options: -h, --help show this help message and exit required arguments: -i [ ...], --input [ ...] Input file(s) and/or folder(s). '.tre' file(s) from ganon report. (default: None) -e , --input-extension Required if --input contains folder(s). Wildcards/Shell Expansions not supported (e.g. *). (default: tre) -o OUTPUT_FILE, --output-file OUTPUT_FILE Output filename for the table (default: None) output arguments: -l , --output-value Output value on the table [percentage, counts]. percentage values are reported between [0-1] (default: counts) -f , --output-format Output format [tsv, csv] (default: tsv) -t , --top-sample Top hits of each sample individually (default: 0) -a , --top-all Top hits of all samples (ranked by percentage) (default: 0) -m , --min-frequency Minimum number/percentage of files containing an taxa to keep the taxa [values between 0-1 for percentage, >1 specific number] (default: 0) -r , --rank Define specific rank to report. Empty will report all ranks. (default: None) -n, --no-root Do not report root node entry and lineage. Direct and shared matches to root will be accounted as unclassified (default: False) --header Header information [name, taxid, lineage] (default: name) --unclassified-label Add column with unclassified count/percentage with the chosen label. May be the same as --filtered-label (e.g. unassigned) (default: None) --filtered-label Add column with filtered count/percentage with the chosen label. May be the same as --unclassified-label (e.g. unassigned) (default: None) --skip-zeros Do not print lines with only zero count/percentage (default: False) --transpose Transpose output table (taxa as cols and files as rows) (default: False) optional arguments: --verbose Verbose output mode (default: False) --quiet Quiet output mode (default: False) filter arguments: --min-count Minimum number/percentage of counts to keep an taxa [values between 0-1 for percentage, >1 specific number] (default: 0) --max-count Maximum number/percentage of counts to keep an taxa [values between 0-1 for percentage, >1 specific number] (default: 0) --names [ ...] Show only entries matching exact names of the provided list (default: []) --names-with [ ...] Show entries containing full or partial names of the provided list (default: []) --taxids [ ...] One or more taxids to report (including children taxa) (default: [])","title":"ganon"},{"location":"#ganon","text":"GitHub repository ganon is designed to index large sets of genomic reference sequences and to classify reads against them efficiently. The tool uses Interleaved Bloom Filters as indices based on k-mers/minimizers. It was mainly developed, but not limited, to the metagenomics classification problem: quickly assign sequence fragments to their closest reference among thousands of references. After classification, taxonomic abundance is estimated and reported.","title":"ganon"},{"location":"#features","text":"NCBI and GTDB native support for taxonomic classification (also runs without taxonomy) integrated download of commonly used reference sequences from RefSeq/Genbank ( ganon build ) update indices incrementally ( ganon update ) customizable build for pre-downloaded or non-standard sequence files ( ganon build-custom ) build and classify at different taxonomic levels, file, sequence, strain/assembly or custom specialization perform hierarchical classification : use several databases in any order report the lowest common ancestor (LCA) but also multiple and unique matches for every read report sequence or taxonomic abundances as well as total number of matches reassignment of reads with multiple matches to a unique match with an EM algorithm generate reports and contingency tables for multi-sample studies with several filter options ganon achieved very good results in our own evaluations but also in independent evaluations: LEMMI , LEMMI v2 and CAMI2","title":"Features"},{"location":"#installation-with-conda","text":"The easiest way to install ganon is via conda, using the bioconda and conda-forge channels: conda install -c bioconda -c conda-forge ganon However, there are possible performance benefits compiling ganon from source in the target machine rather than using the conda version. To do so, please follow the instructions below:","title":"Installation with conda"},{"location":"#installation-from-source","text":"","title":"Installation from source"},{"location":"#dependencies","text":"gcc >=7 cmake >=3.10 zlib python >=3.6 pandas >=1.1.0 multitax >=1.3.1 python3 -V # >=3.6 python3 -m pip install \"pandas>=1.1.0\" \"multitax>=1.3.1\"","title":"Dependencies"},{"location":"#downloading-and-building-ganon-submodules","text":"git clone --recurse-submodules https://github.com/pirovc/ganon.git cd ganon python3 setup.py install --record files.txt # optional mkdir build_cpp cd build_cpp cmake -DCMAKE_BUILD_TYPE=Release -DVERBOSE_CONFIG=ON -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DCONDA=OFF -DLONGREADS=OFF .. make sudo make install # optional to change install location (e.g. /myprefix/bin/ ), set the installation prefix in the cmake command with -DCMAKE_INSTALL_PREFIX=/myprefix/ use -DINCLUDE_DIRS to set alternative paths to cxxopts and Catch2 libs. to classify extremely large reads (>65000bp) use -DLONGREADS=\u00d2N If everything was properly installed, the following commands should show the help pages without errors: ganon -h","title":"Downloading and building ganon + submodules"},{"location":"#running-tests","text":"python3 -m unittest discover -s tests/ganon/integration/ python3 -m unittest discover -s tests/ganon/integration_online/ # optional - downloads large files cd build_cpp/ ctest -VV .","title":"Running tests"},{"location":"#important-parameters","text":"The most important parameters and trade-offs are: ganon build --hibf : build smaller databases that can be queried faster. Building will take longer. ganon build --window-size --kmer-size : the window value should always be the same or larger than the kmer value. The larger the difference between them, the smaller the database will be. However, some sensitivity/precision loss in classification is expected with small kmer and/or large window . Larger kmer values (e.g. 31 ) will improve classification, specially read binning, at a cost of way bigger databases. ganon classify --rel-cutoff : this value defines the threshold for matches between reads and database. Higher --rel-cutoff values will improve precision and decrease sensitivity with expected less unique matches but an increase in overall matches. For taxonomic profiling, a higher value between 0.4 and 0.8 may provide better results. For read binning, lower values between 0.2 and 0.4 are recommended. ganon classify --rel-filter : further filter top matches after cutoff is applied. Usually set between 0 and 0.2 . ganon classify --reassign : runs an EM-algorithm to reassign reads that received multiple matches. It provides a unique match for each read at the level the database was built (e.g. assembly or species). Mostly useful for read binning, with little overall impact on taxonomic profiling. Can be used independently with ganon reassign . ganon report --report-type : reports either taxonomic, sequence or matches abundances. Use corr or abundance for taxonomic profiling, reads or dist for sequence profiling and matches to report a summary of all matches. ganon report --min-count : cutoff to discard underrepresented taxa. Useful to remove the common long tail of spurious matches and false positives when performing classification. Values between 0.0001 (0.01%) and 0.001 (0.1%) improved sensitivity and precision in our evaluations. The higher the value, the more precise the outcome, with a sensitivity loss. Alternatively --top-percentile can be used to keep a relative amount of taxa instead a hard cutoff. The numeric values above are averages from several experiments with different sample types and database contents. They may not work as expected for your data. If you are not sure which values to use or see something unexpected, please open an issue .","title":"Important parameters"},{"location":"#parameters","text":"usage: ganon [-h] [-v] {build,build-custom,update,classify,reassign,report,table} ... - - - - - - - - - - _ _ _ _ _ (_|(_|| |(_)| | _| v. 1.6.0 - - - - - - - - - - positional arguments: {build,build-custom,update,classify,reassign,report,table} build Download and build ganon default databases (refseq/genbank) build-custom Build custom ganon databases update Update ganon default databases classify Classify reads against built databases reassign Reassign reads with multiple matches with an EM algorithm report Generate reports from classification results table Generate table from reports options: -h, --help show this help message and exit -v, --version Show program's version number and exit. ganon build usage: ganon build [-h] [-g [...]] [-a [...]] [-b [...]] [-o] [-c] [-u] [-m [...]] [-z [...]] -d DB_PREFIX [-x] [-t] [-p] [-f] [-k] [-w] [-s] [-j] [-y] [--hibf] [--restart] [--verbose] [--quiet] [--write-info-file] options: -h, --help show this help message and exit required arguments: -g [ ...], --organism-group [ ...] One or more organism groups to download [archaea, bacteria, fungi, human, invertebrate, metagenomes, other, plant, protozoa, vertebrate_mammalian, vertebrate_other, viral]. Mutually exclusive --taxid (default: None) -a [ ...], --taxid [ ...] One or more taxonomic identifiers to download. e.g. 562 (-x ncbi) or 's__Escherichia coli' (-x gtdb). Mutually exclusive --organism-group (default: None) -d DB_PREFIX, --db-prefix DB_PREFIX Database output prefix (default: None) download arguments: -b [ ...], --source [ ...] Source to download [refseq, genbank] (default: ['refseq']) -o , --top Download limited assemblies for each taxa. 0 for all. (default: 0) -c, --complete-genomes Download only sub-set of complete genomes (default: False) -u , --genome-updater Additional genome_updater parameters (https://github.com/pirovc/genome_updater) (default: None) -m [ ...], --taxonomy-files [ ...] Specific files for taxonomy - otherwise files will be downloaded (default: None) -z [ ...], --genome-size-files [ ...] Specific files for genome size estimation - otherwise files will be downloaded (default: None) important arguments: -x , --taxonomy Set taxonomy to enable taxonomic classification, lca and reports [ncbi, gtdb, skip] (default: ncbi) -t , --threads advanced arguments: -p , --max-fp Max. false positive rate for bloom filters Mutually exclusive --filter-size. (default: 0.05) -f , --filter-size Fixed size for filter in Megabytes (MB). Mutually exclusive --max-fp. (default: 0) -k , --kmer-size The k-mer size to split sequences. (default: 19) -w , --window-size The window-size to build filter with minimizers. (default: 31) -s , --hash-functions The number of hash functions for the interleaved bloom filter [0-5]. 0 to detect optimal value. (default: 4) -j , --mode Create smaller or faster filters at the cost of classification speed or database size, respectively [avg, smaller, smallest, faster, fastest]. If --filter-size is used, smaller/smallest refers to the false positive rate. By default, an average value is calculated to balance classification speed and database size. (default: avg) -y , --min-length Skip sequences smaller then value defined. 0 to not skip any sequence. (default: 0) --hibf Builds an HIBF with raptor/chopper (v3). --mode, --filter-size and --min-length will be ignored. (default: False) optional arguments: --restart Restart build/update from scratch, do not try to resume from the latest possible step. {db_prefix}_files/ will be deleted if present. (default: False) --verbose Verbose output mode (default: False) --quiet Quiet output mode (default: False) --write-info-file Save copy of target info generated to {db_prefix}.info.tsv. Can be re-used as --input-file for further attempts. (default: False) ganon build-custom usage: ganon build-custom [-h] [-i [...]] [-e] [-c] [-n] [-a] [-l] [-m [...]] [-z [...]] [-r [...]] [-q [...]] -d DB_PREFIX [-x] [-t] [-p] [-f] [-k] [-w] [-s] [-j] [-y] [--hibf] [--restart] [--verbose] [--quiet] [--write-info-file] options: -h, --help show this help message and exit required arguments: -i [ ...], --input [ ...] Input file(s) and/or folder(s). Mutually exclusive --input-file. (default: None) -e , --input-extension Required if --input contains folder(s). Wildcards/Shell Expansions not supported (e.g. *). (default: fna.gz) -c, --input-recursive Look for files recursively in folder(s) provided with --input (default: False) -d DB_PREFIX, --db-prefix DB_PREFIX Database output prefix (default: None) custom arguments: -n , --input-file Manually set information for input files: file <tab> [target <tab> node <tab> specialization <tab> specialization name]. target is the sequence identifier if --input-target sequence (file can be repeated for multiple sequences). if --input-target file and target is not set, filename is used. node is the taxonomic identifier. Mutually exclusive --input (default: None) -a , --input-target Target to use [file, sequence]. By default: 'file' if multiple input files are provided or --input-file is set, 'sequence' if a single file is provided. Using 'file' is recommended and will speed-up the building process (default: None) -l , --level Use a specialized target to build the database. By default, --level is the --input-target. Options: any available taxonomic rank [species, genus, ...] or 'leaves' (requires --taxonomy). Further specialization options [assembly, custom]. assembly will retrieve and use the assembly accession and name. custom requires and uses the specialization field in the --input-file. (default: None) -m [ ...], --taxonomy-files [ ...] Specific files for taxonomy - otherwise files will be downloaded (default: None) -z [ ...], --genome-size-files [ ...] Specific files for genome size estimation - otherwise files will be downloaded (default: None) ncbi arguments: -r [ ...], --ncbi-sequence-info [ ...] Uses NCBI e-utils webservices or downloads accession2taxid files to extract target information. [eutils, nucl_gb, nucl_wgs, nucl_est, nucl_gss, pdb, prot, dead_nucl, dead_wgs, dead_prot or one or more accession2taxid files from https://ftp.ncbi.nlm.nih.gov/pub/taxonomy/accession2taxid/]. By default uses e-utils up-to 50000 sequences or downloads nucl_gb nucl_wgs otherwise. (default: []) -q [ ...], --ncbi-file-info [ ...] Downloads assembly_summary files to extract target information. [refseq, genbank, refseq_historical, genbank_historical or one or more assembly_summary files from https://ftp.ncbi.nlm.nih.gov/genomes/] (default: ['refseq', 'genbank']) important arguments: -x , --taxonomy Set taxonomy to enable taxonomic classification, lca and reports [ncbi, gtdb, skip] (default: ncbi) -t , --threads advanced arguments: -p , --max-fp Max. false positive rate for bloom filters Mutually exclusive --filter-size. (default: 0.05) -f , --filter-size Fixed size for filter in Megabytes (MB). Mutually exclusive --max-fp. (default: 0) -k , --kmer-size The k-mer size to split sequences. (default: 19) -w , --window-size The window-size to build filter with minimizers. (default: 31) -s , --hash-functions The number of hash functions for the interleaved bloom filter [0-5]. 0 to detect optimal value. (default: 4) -j , --mode Create smaller or faster filters at the cost of classification speed or database size, respectively [avg, smaller, smallest, faster, fastest]. If --filter-size is used, smaller/smallest refers to the false positive rate. By default, an average value is calculated to balance classification speed and database size. (default: avg) -y , --min-length Skip sequences smaller then value defined. 0 to not skip any sequence. (default: 0) --hibf Builds an HIBF with raptor/chopper (v3). --mode, --filter-size and --min-length will be ignored. (default: False) optional arguments: --restart Restart build/update from scratch, do not try to resume from the latest possible step. {db_prefix}_files/ will be deleted if present. (default: False) --verbose Verbose output mode (default: False) --quiet Quiet output mode (default: False) --write-info-file Save copy of target info generated to {db_prefix}.info.tsv. Can be re-used as --input-file for further attempts. (default: False) ganon update usage: ganon update [-h] -d DB_PREFIX [-o] [-t] [--restart] [--verbose] [--quiet] [--write-info-file] options: -h, --help show this help message and exit required arguments: -d DB_PREFIX, --db-prefix DB_PREFIX Existing database input prefix (default: None) important arguments: -o , --output-db-prefix Output database prefix. By default will be the same as --db-prefix and overwrite files (default: None) -t , --threads optional arguments: --restart Restart build/update from scratch, do not try to resume from the latest possible step. {db_prefix}_files/ will be deleted if present. (default: False) --verbose Verbose output mode (default: False) --quiet Quiet output mode (default: False) --write-info-file Save copy of target info generated to {db_prefix}.info.tsv. Can be re-used as --input-file for further attempts. (default: False) ganon classify usage: ganon classify [-h] -d [DB_PREFIX ...] [-s [reads.fq[.gz] ...]] [-p [reads.1.fq[.gz] reads.2.fq[.gz] ...]] [-c [...]] [-e [...]] [-o] [--output-lca] [--output-all] [--output-unclassified] [--output-single] [-t] [-l [...]] [-r [...]] [-a] [--verbose] [--quiet] options: -h, --help show this help message and exit required arguments: -d [DB_PREFIX ...], --db-prefix [DB_PREFIX ...] Database input prefix[es] (default: None) -s [reads.fq[.gz] ...], --single-reads [reads.fq[.gz] ...] Multi-fastq[.gz] file[s] to classify (default: None) -p [reads.1.fq[.gz] reads.2.fq[.gz] ...], --paired-reads [reads.1.fq[.gz] reads.2.fq[.gz] ...] Multi-fastq[.gz] pairs of file[s] to classify (default: None) cutoff/filter arguments: -c [ ...], --rel-cutoff [ ...] Min. percentage of a read (set of minimizers) shared with the a reference necessary to consider a match. Generally used to cutoff low similarity matches. Single value or one per database (e.g. 0.7 1 0.25). 0 for no cutoff (default: [0.75]) -e [ ...], --rel-filter [ ...] Additional relative percentage of minimizers (relative to the best match) to keep a match. Generally used to select best matches above cutoff. Single value or one per hierarchy (e.g. 0.1 0). 1 for no filter (default: [0.0]) output arguments: -o , --output-prefix Output prefix for output (.rep) and report (.tre). Empty to output to STDOUT (only .rep) (default: None) --output-lca Output an additional file with one lca match for each read (.lca) (default: False) --output-all Output an additional file with all matches. File can be very large (.all) (default: False) --output-unclassified Output an additional file with unclassified read headers (.unc) (default: False) --output-single When using multiple hierarchical levels, output everything in one file instead of one per hierarchy (default: False) other arguments: -t , --threads Number of sub-processes/threads to use (default: 1) -l [ ...], --hierarchy-labels [ ...] Hierarchy definition of --db-prefix files to be classified. Can also be a string, but input will be sorted to define order (e.g. 1 1 2 3). The default value reported without hierarchy is 'H1' (default: None) -r [ ...], --ranks [ ...] Ranks to report taxonomic abundances (.tre). empty will report default ranks [superkingdom, phylum, class, order, family, genus, species, assembly]. This file can be re-generated with the 'ganon report' command for other types of abundances (reads, matches) with further filtration and output options (default: []) -a, --reassign Reassign reads with multiple matches with an EM algorithm. Will enforce --output-all. This file can be re-generated with the 'ganon reassign'. (default: False) --verbose Verbose output mode (default: False) --quiet Quiet output mode (default: False) ganon reassign usage: ganon reassign [-h] -i -o OUTPUT_PREFIX [-e] [-s] [--verbose] [--quiet] options: -h, --help show this help message and exit required arguments: -i , --input-prefix Input prefix to find files from ganon classify (.all and optionally .rep) (default: None) -o OUTPUT_PREFIX, --output-prefix OUTPUT_PREFIX Output prefix for reassigned file (.all and optionally .rep). In case of multiple files, the base input filename will be appended at the end of the output file 'output_prefix + FILENAME.all' (default: None) EM arguments: -e , --max-iter Max. number of iterations for the EM algorithm. If 0, will run until convergence (check --threshold) (default: 10) -s , --threshold Convergence threshold limit to stop the EM algorithm. (default: 0) other arguments: --verbose Verbose output mode (default: False) --quiet Quiet output mode (default: False) ganon report usage: ganon report [-h] -i [...] [-e INPUT_EXTENSION] -o OUTPUT_PREFIX [-d [...]] [-x] [-m [...]] [-z [...]] [-f] [-t] [-r [...]] [-s] [-a] [-y] [-p [...]] [-k [...]] [-c] [--verbose] [--quiet] [--min-count] [--max-count] [--names [...]] [--names-with [...]] [--taxids [...]] options: -h, --help show this help message and exit required arguments: -i [ ...], --input [ ...] Input file(s) and/or folder(s). '.rep' file(s) from ganon classify. (default: None) -e INPUT_EXTENSION, --input-extension INPUT_EXTENSION Required if --input contains folder(s). Wildcards/Shell Expansions not supported (e.g. *). (default: rep) -o OUTPUT_PREFIX, --output-prefix OUTPUT_PREFIX Output prefix for report file 'output_prefix.tre'. In case of multiple files, the base input filename will be appended at the end of the output file 'output_prefix + FILENAME.tre' (default: None) db/tax arguments: -d [ ...], --db-prefix [ ...] Database prefix(es) used for classification. Only '.tax' file(s) are required. If not provided, new taxonomy will be downloaded. Mutually exclusive with --taxonomy. (default: []) -x , --taxonomy Taxonomy database to use [ncbi, gtdb, skip]. Mutually exclusive with --db-prefix. (default: ncbi) -m [ ...], --taxonomy-files [ ...] Specific files for taxonomy - otherwise files will be downloaded (default: None) -z [ ...], --genome-size-files [ ...] Specific files for genome size estimation - otherwise files will be downloaded (default: None) output arguments: -f , --output-format Output format [text, tsv, csv, bioboxes]. text outputs a tabulated formatted text file for better visualization. bioboxes is the the CAMI challenge profiling format (only percentage/abundances are reported). (default: tsv) -t , --report-type Type of report [abundance, reads, matches, dist, corr]. 'abundance' -> tax. abundance (re- distribute read counts and correct by genome size), 'reads' -> sequence abundance, 'matches' -> report all unique and shared matches, 'dist' -> like reads with re-distribution of shared read counts only, 'corr' -> like abundance without re-distribution of shared read counts (default: abundance) -r [ ...], --ranks [ ...] Ranks to report ['', 'all', custom list]. 'all' for all possible ranks. empty for default ranks [superkingdom, phylum, class, order, family, genus, species, assembly]. (default: []) -s , --sort Sort report by [rank, lineage, count, unique]. Default: rank (with custom --ranks) or lineage (with --ranks all) (default: ) -a, --no-orphan Omit orphan nodes from the final report. Otherwise, orphan nodes (= nodes not found in the db/tax) are reported as 'na' with root as direct parent. (default: False) -y, --split-hierarchy Split output reports by hierarchy (from ganon classify --hierarchy-labels). If activated, the output files will be named as '{output_prefix}.{hierarchy}.tre' (default: False) -p [ ...], --skip-hierarchy [ ...] One or more hierarchies to skip in the report (from ganon classify --hierarchy-labels) (default: []) -k [ ...], --keep-hierarchy [ ...] One or more hierarchies to keep in the report (from ganon classify --hierarchy-labels) (default: []) -c , --top-percentile Top percentile filter, based on percentage/relative abundance. Applied only at default ranks [superkingdom, phylum, class, order, family, genus, species, assembly] (default: 0) optional arguments: --verbose Verbose output mode (default: False) --quiet Quiet output mode (default: False) filter arguments: --min-count Minimum number/percentage of counts to keep an taxa [values between 0-1 for percentage, >1 specific number] (default: 0) --max-count Maximum number/percentage of counts to keep an taxa [values between 0-1 for percentage, >1 specific number] (default: 0) --names [ ...] Show only entries matching exact names of the provided list (default: []) --names-with [ ...] Show entries containing full or partial names of the provided list (default: []) --taxids [ ...] One or more taxids to report (including children taxa) (default: []) ganon table usage: ganon table [-h] -i [...] [-e] -o OUTPUT_FILE [-l] [-f] [-t] [-a] [-m] [-r] [-n] [--header] [--unclassified-label] [--filtered-label] [--skip-zeros] [--transpose] [--verbose] [--quiet] [--min-count] [--max-count] [--names [...]] [--names-with [...]] [--taxids [...]] options: -h, --help show this help message and exit required arguments: -i [ ...], --input [ ...] Input file(s) and/or folder(s). '.tre' file(s) from ganon report. (default: None) -e , --input-extension Required if --input contains folder(s). Wildcards/Shell Expansions not supported (e.g. *). (default: tre) -o OUTPUT_FILE, --output-file OUTPUT_FILE Output filename for the table (default: None) output arguments: -l , --output-value Output value on the table [percentage, counts]. percentage values are reported between [0-1] (default: counts) -f , --output-format Output format [tsv, csv] (default: tsv) -t , --top-sample Top hits of each sample individually (default: 0) -a , --top-all Top hits of all samples (ranked by percentage) (default: 0) -m , --min-frequency Minimum number/percentage of files containing an taxa to keep the taxa [values between 0-1 for percentage, >1 specific number] (default: 0) -r , --rank Define specific rank to report. Empty will report all ranks. (default: None) -n, --no-root Do not report root node entry and lineage. Direct and shared matches to root will be accounted as unclassified (default: False) --header Header information [name, taxid, lineage] (default: name) --unclassified-label Add column with unclassified count/percentage with the chosen label. May be the same as --filtered-label (e.g. unassigned) (default: None) --filtered-label Add column with filtered count/percentage with the chosen label. May be the same as --unclassified-label (e.g. unassigned) (default: None) --skip-zeros Do not print lines with only zero count/percentage (default: False) --transpose Transpose output table (taxa as cols and files as rows) (default: False) optional arguments: --verbose Verbose output mode (default: False) --quiet Quiet output mode (default: False) filter arguments: --min-count Minimum number/percentage of counts to keep an taxa [values between 0-1 for percentage, >1 specific number] (default: 0) --max-count Maximum number/percentage of counts to keep an taxa [values between 0-1 for percentage, >1 specific number] (default: 0) --names [ ...] Show only entries matching exact names of the provided list (default: []) --names-with [ ...] Show entries containing full or partial names of the provided list (default: []) --taxids [ ...] One or more taxids to report (including children taxa) (default: [])","title":"Parameters"},{"location":"classification/","text":"Classification :) ganon classify will match single and/or paired-end reads against one or more databases , for example: ganon classify --db-prefix my_db --paired-reads reads.1.fq.gz reads.2.fq.gz --output-prefix results --threads 32 ganon report will be automatically executed after classification and a report will be created ( .tre ). ganon can generate both taxonomic profiling and binning results with ganon classify + ganon report . Please choose the parameters according to your application. Profiling :) ganon classify is set-up by default to perform taxonomic profiling. It uses: strict --rel-cutoff and --rel-filter values ( 0.75 and 0 , respectively) --min-count 0.0001 (0.01%) on ganon report to exclude low abundant groups --report-type abundance on ganon report to generate taxonomic abundances, re-distributing read counts and correcting for genome sizes Binning :) To achieve better results for binning reads to specific references, ganon can be configured with: --output-all and --output-lca to write .all .lca files for binning results less strict --rel-cutoff and --rel-filter values (e.g. 0.25 and 0.1 , respectively) activate the --reassign on ganon classify (or use the ganon reassign procedure) to apply a EM algorithm, re-assigning reads with LCA matches to most probable target ( --level the database was built) Tip Higher --kmer-size values on ganon build can also improve read binning sensitivity Multiple and Hierarchical classification :) ganon classify can be performed in multiple databases at the same time. The databases can also be provided in a hierarchical order. Multiple database classification can be performed providing several inputs for --db-prefix . They are required to be built with the same --kmer-size and --window-size values. Multiple databases are considered as one (as if built together) and redundancy in content (same reference in two or more databases) is allowed. To classify reads in a hierarchical order, --hierarchy-labels should be provided. When using multiple hierarchical levels, output files will be generated for each level (use --output-single to generate a single output from multiple hierarchical levels). Please note that some parameters are set for each database (e.g. --rel-cutoff ) while others are set for each hierarchical level (e.g. --rel-filter ) Examples Classification against 3 database (as if they were one) using the same cutoff: ganon classify --db-prefix db1 db2 db3 \\ --rel-cutoff 0.75 \\ --single-reads reads.fq.gz Classification against 3 database (as if they were one) using different error rates for each: ganon classify --db-prefix db1 db2 db3 \\ --rel-cutoff 0.2 0.3 0.1 \\ --single-reads reads.fq.gz In this example, reads are going to be classified first against db1 and db2. Reads without a valid match will be further classified against db3. `--hierarchy-labels` are strings and are going to be sorted to define the hierarchy order, disregarding input order: ganon classify --db-prefix db1 db2 db3 \\ --hierarchy-labels 1_first 1_first 2_second \\ --single-reads reads.fq.gz In this example, classification will be performed with different `--rel-cutoff` for each database. For each hierarchy levels (`1_first` and `2_second`) a different `--rel-filter` will be used: ganon classify --db-prefix db1 db2 db3 \\ --hierarchy-labels 1_first 1_first 2_second \\ --rel-cutoff 1 0.5 0.25 \\ --rel-filter 0.1 0.5 \\ --single-reads reads.fq.gz Parameter details :) reads (--single-reads, --paired-reads) :) ganon accepts single-end and paired-end reads. Both types can be use at the same time. In paired-end mode, reads are always reported with the header of the first pair. Paired-end reads are classified in a standard forward-reverse orientation. The max. read length accepted is 65535 (accounting both reads in paired mode). cutoff and filter (--rel-cutoff, --rel-filter) :) ganon has two parameters to control a match between reads and references: --rel-cutoff and --rel-filter . Every read can be classified against none, one or more references. What will be reported is the remaining matches after cutoff and filter thresholds are applied, based on the number of shared minimizers (or k-mers) between sequences. The cutoff is the first. It should be set as a minimal value to consider a match between a read and a reference. Next the filter is applied to the remaining matches. filter thresholds are relative to the best scoring match and control how far from the best match further matches are allowed. cutoff can be interpreted as the lower bound to discard spurious matches and filter as the fine tuning to control what to keep. For example, using --kmer-size 19 (and --window-size 19 to simplify the example), a certain read (100bp) has the following matches with the 5 references ( ref1..5 ), sorted by shared k-mers: reference shared k-mers ref1 82 ref2 68 ref3 44 ref4 25 ref5 20 this read can have at most 82 shared k-mers ( 100-19+1=82 ). With --rel-cutoff 0.25 , the following matches will be discarded: reference shared k-mers --rel-cutoff 0.25 ref1 82 ref2 68 ref3 44 ref4 25 ~~ref5~~ ~~20~~ X since the --rel-cutoff threshold is 82 * 0.25 = 21 (ceiling is applied). Further, with --rel-filter 0.3 , the following matches will be discarded: reference shared k-mers --rel-cutoff 0.25 --rel-filter 0.3 ref1 82 ref2 68 ~~ref3~~ ~~44~~ X ~~ref4~~ ~~25~~ X ~~ref5~~ ~~20~~ X since best match is 82, the filter parameter is removing any match below 0.3 * 82 = 57 (ceiling is applied) shared k-mers. ref1 and ref2 are reported as matches. For databases built with --window-size , the relative values are not based on the maximum number of possible shared k-mers but on the actual number of unique minimizers extracted from the read. A different cutoff can be set for every database in a multiple or hierarchical database classification. A different filter can be set for every level of a hierarchical database classification. Note that reads that remain with only one reference match (after cutoff and filter are applied) are considered a unique match.","title":"Classification (ganon classify)"},{"location":"classification/#classification","text":"ganon classify will match single and/or paired-end reads against one or more databases , for example: ganon classify --db-prefix my_db --paired-reads reads.1.fq.gz reads.2.fq.gz --output-prefix results --threads 32 ganon report will be automatically executed after classification and a report will be created ( .tre ). ganon can generate both taxonomic profiling and binning results with ganon classify + ganon report . Please choose the parameters according to your application.","title":"Classification"},{"location":"classification/#profiling","text":"ganon classify is set-up by default to perform taxonomic profiling. It uses: strict --rel-cutoff and --rel-filter values ( 0.75 and 0 , respectively) --min-count 0.0001 (0.01%) on ganon report to exclude low abundant groups --report-type abundance on ganon report to generate taxonomic abundances, re-distributing read counts and correcting for genome sizes","title":"Profiling"},{"location":"classification/#binning","text":"To achieve better results for binning reads to specific references, ganon can be configured with: --output-all and --output-lca to write .all .lca files for binning results less strict --rel-cutoff and --rel-filter values (e.g. 0.25 and 0.1 , respectively) activate the --reassign on ganon classify (or use the ganon reassign procedure) to apply a EM algorithm, re-assigning reads with LCA matches to most probable target ( --level the database was built) Tip Higher --kmer-size values on ganon build can also improve read binning sensitivity","title":"Binning"},{"location":"classification/#multiple-and-hierarchical-classification","text":"ganon classify can be performed in multiple databases at the same time. The databases can also be provided in a hierarchical order. Multiple database classification can be performed providing several inputs for --db-prefix . They are required to be built with the same --kmer-size and --window-size values. Multiple databases are considered as one (as if built together) and redundancy in content (same reference in two or more databases) is allowed. To classify reads in a hierarchical order, --hierarchy-labels should be provided. When using multiple hierarchical levels, output files will be generated for each level (use --output-single to generate a single output from multiple hierarchical levels). Please note that some parameters are set for each database (e.g. --rel-cutoff ) while others are set for each hierarchical level (e.g. --rel-filter ) Examples Classification against 3 database (as if they were one) using the same cutoff: ganon classify --db-prefix db1 db2 db3 \\ --rel-cutoff 0.75 \\ --single-reads reads.fq.gz Classification against 3 database (as if they were one) using different error rates for each: ganon classify --db-prefix db1 db2 db3 \\ --rel-cutoff 0.2 0.3 0.1 \\ --single-reads reads.fq.gz In this example, reads are going to be classified first against db1 and db2. Reads without a valid match will be further classified against db3. `--hierarchy-labels` are strings and are going to be sorted to define the hierarchy order, disregarding input order: ganon classify --db-prefix db1 db2 db3 \\ --hierarchy-labels 1_first 1_first 2_second \\ --single-reads reads.fq.gz In this example, classification will be performed with different `--rel-cutoff` for each database. For each hierarchy levels (`1_first` and `2_second`) a different `--rel-filter` will be used: ganon classify --db-prefix db1 db2 db3 \\ --hierarchy-labels 1_first 1_first 2_second \\ --rel-cutoff 1 0.5 0.25 \\ --rel-filter 0.1 0.5 \\ --single-reads reads.fq.gz","title":"Multiple and Hierarchical classification"},{"location":"classification/#parameter-details","text":"","title":"Parameter details"},{"location":"classification/#reads-single-reads-paired-reads","text":"ganon accepts single-end and paired-end reads. Both types can be use at the same time. In paired-end mode, reads are always reported with the header of the first pair. Paired-end reads are classified in a standard forward-reverse orientation. The max. read length accepted is 65535 (accounting both reads in paired mode).","title":"reads (--single-reads, --paired-reads)"},{"location":"classification/#cutoff-and-filter-rel-cutoff-rel-filter","text":"ganon has two parameters to control a match between reads and references: --rel-cutoff and --rel-filter . Every read can be classified against none, one or more references. What will be reported is the remaining matches after cutoff and filter thresholds are applied, based on the number of shared minimizers (or k-mers) between sequences. The cutoff is the first. It should be set as a minimal value to consider a match between a read and a reference. Next the filter is applied to the remaining matches. filter thresholds are relative to the best scoring match and control how far from the best match further matches are allowed. cutoff can be interpreted as the lower bound to discard spurious matches and filter as the fine tuning to control what to keep. For example, using --kmer-size 19 (and --window-size 19 to simplify the example), a certain read (100bp) has the following matches with the 5 references ( ref1..5 ), sorted by shared k-mers: reference shared k-mers ref1 82 ref2 68 ref3 44 ref4 25 ref5 20 this read can have at most 82 shared k-mers ( 100-19+1=82 ). With --rel-cutoff 0.25 , the following matches will be discarded: reference shared k-mers --rel-cutoff 0.25 ref1 82 ref2 68 ref3 44 ref4 25 ~~ref5~~ ~~20~~ X since the --rel-cutoff threshold is 82 * 0.25 = 21 (ceiling is applied). Further, with --rel-filter 0.3 , the following matches will be discarded: reference shared k-mers --rel-cutoff 0.25 --rel-filter 0.3 ref1 82 ref2 68 ~~ref3~~ ~~44~~ X ~~ref4~~ ~~25~~ X ~~ref5~~ ~~20~~ X since best match is 82, the filter parameter is removing any match below 0.3 * 82 = 57 (ceiling is applied) shared k-mers. ref1 and ref2 are reported as matches. For databases built with --window-size , the relative values are not based on the maximum number of possible shared k-mers but on the actual number of unique minimizers extracted from the read. A different cutoff can be set for every database in a multiple or hierarchical database classification. A different filter can be set for every level of a hierarchical database classification. Note that reads that remain with only one reference match (after cutoff and filter are applied) are considered a unique match.","title":"cutoff and filter (--rel-cutoff, --rel-filter)"},{"location":"custom_databases/","text":"Custom databases :) Default NCBI assembly or sequence accession :) Besides the automated download and build ( ganon build ) ganon provides a highly customizable build procedure ( ganon build-custom ) to create databases from local sequence files. To use custom sequences, just provide them with --input . ganon will try to retrieve all necessary information necessary to build a database. Note ganon expects assembly accessions in the filename like GCA_002211645.1_ASM221164v1_genomic.fna.gz . When using --input-target sequence filenames are not important but sequence headers should contain sequence accessions like >CP022124.1 Fusobacterium nu... . More information about building by file or sequence can be found here . Non-standard/custom accessions :) It is also possible to use non-standard accessions and headers to build custom databases with --input-file . This file should contain the following fields (tab-separated): file [<tab> target <tab> node <tab> specialization <tab> specialization_name]. Note that file is mandatory and additional fields not. Tip If you just want to build a database without any taxonomic or target information, just sent the files with --input , use --taxonomy skip and choose between --input-target file or sequence . Examples of --input-file With --input-target file (default), where my_target_1 and my_target_2 are just names to assign sequences from (unique) sequence files: sequences.fasta my_target_1 others.fasta my_target_2 With --input-target sequence, second column should match sequence headers on provided sequence files (that should be repeated for each header): sequences.fasta HEADER1 sequences.fasta HEADER2 sequences.fasta HEADER3 others.fasta HEADER4 others.fasta HEADER5 A third column with taxonomic nodes can be provided to link the data with taxonomy. For example with --taxonomy ncbi: sequences.fasta FILE_A 562 others.fasta FILE_B 623 sequences.fasta HEADER1 562 sequences.fasta HEADER2 562 sequences.fasta HEADER3 562 others.fasta HEADER4 623 others.fasta HEADER5 623 Further specializations can be used to create a additional classification level after the taxonomic leaves. For example (using --level custom): sequences.fasta FILE_A 562 ID44444 Escherichia coli TW10119 others.fasta FILE_B 623 ID55555 Shigella flexneri 1a sequences.fasta HEADER1 562 ID443 Escherichia coli TW10119 sequences.fasta HEADER2 562 ID297 Escherichia coli PCN079 sequences.fasta HEADER3 562 ID8873 Escherichia coli P0301867.7 others.fasta HEADER4 623 ID2241 Shigella flexneri 1a others.fasta HEADER5 623 ID4422 Shigella flexneri 1b Examples :) Some examples with download and build commands for custom ganon databases from useful and commonly used repositories and datasets for metagenomics analysis: HumGut :) Collection of >30000 genomes from healthy human metagenomes. Article / Website . # Download sequence files wget --quiet --show-progress \"http://arken.nmbu.no/~larssn/humgut/HumGut.tar.gz\" tar xf HumGut.tar.gz # Download taxonomy and metadata files wget \"https://arken.nmbu.no/~larssn/humgut/ncbi_nodes.dmp\" wget \"https://arken.nmbu.no/~larssn/humgut/ncbi_names.dmp\" wget \"https://arken.nmbu.no/~larssn/humgut/HumGut.tsv\" # Generate --input-file from metadata tail -n+2 HumGut.tsv | awk -F\"\\t\" '{print \"fna/\"$21\"\\t\"$1\"\\t\"$2}' > HumGut_ganon_input_file.tsv # Build ganon database ganon build-custom --input-file HumGut_ganon_input_file.tsv --taxonomy-files ncbi_nodes.dmp ncbi_names.dmp --db-prefix HumGut --level strain --threads 32 Similarly using GTDB taxonomy files: # Download taxonomy files wget \"https://arken.nmbu.no/~larssn/humgut/gtdb_nodes.dmp\" wget \"https://arken.nmbu.no/~larssn/humgut/gtdb_names.dmp\" # Build ganon database ganon build-custom --input-file HumGut_ganon_input_file.tsv --taxonomy-files gtdb_nodes.dmp gtdb_names.dmp --db-prefix HumGut_gtdb --level strain --threads 32 Note There is no need to use ganon's gtdb integration here since GTDB files in NCBI format are available Plasmid, Plastid and Mitochondrion from RefSeq :) Extra repositories from RefSeq release not included as default databases. Website . # Download sequence files wget -A genomic.fna.gz -m -nd --quiet --show-progress \"ftp://ftp.ncbi.nlm.nih.gov/genomes/refseq/plasmid/\" wget -A genomic.fna.gz -m -nd --quiet --show-progress \"ftp://ftp.ncbi.nlm.nih.gov/genomes/refseq/plastid/\" wget -A genomic.fna.gz -m -nd --quiet --show-progress \"ftp://ftp.ncbi.nlm.nih.gov/genomes/refseq/mitochondrion/\" # Build ganon database ganon build-custom --input plasmid.* plastid.* mitochondrion.* --db-prefix ppm --input-target sequence --level leaves --threads 32 UniVec, UniVec_core :) \"UniVec is a non-redundant database of sequences commonly attached to cDNA or genomic DNA during the cloning process.\" Website . Useful to screen for vector and linker/adapter contamination. UniVec_core is a sub-set of the UniVec selected to reduce the false positive hits from real biological sources. # UniVec wget -O \"UniVec.fasta\" --quiet --show-progress \"ftp://ftp.ncbi.nlm.nih.gov/pub/UniVec/UniVec\" grep -o '^>[^ ]*' UniVec.fasta | sed 's/^>//' | awk '{print \"UniVec.fasta\\t\"$1\"\\t81077\"}' > UniVec_ganon_input_file.tsv ganon build-custom --input-file UniVec_ganon_input_file.tsv --db-prefix UniVec --input-target sequence --level leaves --threads 8 # UniVec_Core wget -O \"UniVec_Core.fasta\" --quiet --show-progress \"ftp://ftp.ncbi.nlm.nih.gov/pub/UniVec/UniVec_Core\" grep -o '^>[^ ]*' UniVec_Core.fasta | sed 's/^>//' | awk '{print \"UniVec_Core.fasta\\t\"$1\"\\t81077\"}' > UniVec_Core_ganon_input_file.tsv ganon build-custom --input-file UniVec_Core_ganon_input_file.tsv --db-prefix UniVec_Core --input-target sequence --level leaves --threads 8 Note All UniVec entries in the examples are categorized as Artificial Sequence (NCBI txid:81077). Some are completely artificial but others may be derived from real biological sources. More information in this link . MGnify genome catalogues (MAGs) :) \"Genome catalogues are biome-specific collections of metagenomic-assembled and isolate genomes\". Article / Website / FTP . There are currently (2023-05-04) 8 genome catalogues available: chicken-gut, human-gut, human-oral, marine, non-model-fish-gut, pig-gut and zebrafish-fecal. An example below how to download and build the human-oral catalog: # Download metadata wget \"https://ftp.ebi.ac.uk/pub/databases/metagenomics/mgnify_genomes/human-oral/v1.0/genomes-all_metadata.tsv\" # Download sequence files with 12 threads tail -n+2 genomes-all_metadata.tsv | cut -f 1,20 | xargs -P 12 -n2 sh -c 'curl --silent ${1}| gzip -d | sed -e \"1,/##FASTA/ d\" | gzip > ${0}.fna.gz' # Generate ganon input file tail -n+2 genomes-all_metadata.tsv | cut -f 1,15 | tr ';' '\\t' | awk -F\"\\t\" '{tax=\"1\";for(i=NF;i>1;i--){if(length($i)>3){tax=$i;break;}};print $1\".fna.gz\\t\"$1\"\\t\"tax}' > ganon_input_file.tsv # Build ganon database ganon build-custom --input-file ganon_input_file.tsv --db-prefix mgnify_human_oral_v1 --taxonomy gtdb --level leaves --threads 32 Note MGnify genomes catalogues will be build with GTDB taxonomy. Pathogen detection FDA-ARGOS :) A collection of >1400 \"microbes that include biothreat microorganisms, common clinical pathogens and closely related species\". Article / Website / BioProject . # Download sequence files wget https://ftp.ncbi.nlm.nih.gov/genomes/refseq/assembly_summary_refseq.txt grep \"strain=FDAARGOS\" assembly_summary_refseq.txt > fdaargos_assembly_summary.txt genome_updater.sh -e fdaargos_assembly_summary.txt -f \"genomic.fna.gz\" -o download -m -t 12 # Build ganon database ganon build-custom --input download/ --input-recursive --db-prefix fdaargos --ncbi-file-info download/assembly_summary.txt --level assembly --threads 32 Note The example above uses genome_updater to download files BLAST databases (nt, env_nt, nt_prok, ...) :) BLAST databases. Website / FTP . Current available nucleotide databases (2023-05-04): 16S_ribosomal_RNA 18S_fungal_sequences 28S_fungal_sequences Betacoronavirus env_nt human_genome ITS_eukaryote_sequences ITS_RefSeq_Fungi LSU_eukaryote_rRNA LSU_prokaryote_rRNA mito mouse_genome nt nt_euk nt_others nt_prok nt_viruses patnt pdbnt ref_euk_rep_genomes ref_prok_rep_genomes refseq_rna refseq_select_rna ref_viroids_rep_genomes ref_viruses_rep_genomes SSU_eukaryote_rRNA tsa_nt Note List currently available nucleotide databases curl --silent --list-only ftp://ftp.ncbi.nlm.nih.gov/blast/db/ | grep \"nucl-metadata.json\" | sed 's/-nucl-metadata.json/, /g' | sort Warning Some BLAST databases are very big and may require extreme computational resources to build. You may need to use some reduction strategies The example below extracts sequences and information from a BLAST db to build a ganon database: # Define BLAST db db=\"16S_ribosomal_RNA\" threads=8 # Download BLAST db - re-run this command many times until all finish (no more output) curl --silent --list-only ftp://ftp.ncbi.nlm.nih.gov/blast/db/ | grep \"^${db}\\..*tar.gz$\" | xargs -P ${threads:-1} -I{} wget --continue -nd --quiet --show-progress \"ftp://ftp.ncbi.nlm.nih.gov/blast/db/{}\" # OPTIONAL Download and check MD5 wget -O - -nd --quiet --show-progress \"ftp://ftp.ncbi.nlm.nih.gov/blast/db/${db}\\.*tar.gz.md5\" > \"${db}.md5\" md5sum \"${db}\".*tar.gz > \"${db}_downloaded.md5\" diff -s <(sort -k 2,2 \"${db}.md5\") <(sort -k 2,2 \"${db}_downloaded.md5\") # Should print \"Files /dev/fd/xx and /dev/fd/xx are identical\" # Extract BLAST db files, if successful, remove .tar.gz ls \"${db}\"*.tar.gz | xargs -P ${threads} -I{} sh -c 'gzip -dc {} | tar --overwrite -vxf - && rm {}' > \"${db}_extracted_files.txt\" # Create folder to write sequence files (split into 10 sub-folders) seq 0 9 | xargs -i mkdir -p \"${db}\"/{} # This command extracts sequences from the blastdb and writes them into taxid specific files # It also generates the --input-file for ganon blastdbcmd -entry all -db \"${db}\" -outfmt \"%a %T %s\" | \\ awk -v db=\"$(realpath ${db})\" '{file=db\"/\"substr($2,1,1)\"/\"$2\".fna\"; print \">\"$1\"\\n\"$3 >> file; print file\"\\t\"$2\"\\t\"$2}' | \\ sort | uniq > \"${db}_ganon_input_file.tsv\" # Build ganon database ganon build-custom --input-file \"${db}_ganon_input_file.tsv\" --db-prefix \"${db}\" --level species --threads 12 # Delete extracted files and auxiliary files cat \"${db}_extracted_files.txt\" | xargs rm rm \"${db}_extracted_files.txt\" \"${db}.md5\" \"${db}_downloaded.md5\" # Delete sequences rm -rf \"${db}\" \"${db}_ganon_input_file.tsv\" Note blastdbcmd is a command from BLAST software suite and should be installed separately Files from genome_updater :) To create a ganon database from files previosly downloaded with genome_updater : ganon build-custom --input output_folder_genome_updater/version/ --input-recursive --db-prefix mydb --ncbi-file-info output_folder_genome_updater/assembly_summary.txt --level assembly --threads 32 Parameter details :) False positive and size (--max-fp, --filter-size) :) ganon indices are based on bloom filters and can have false positive matches. This can be controlled with --max-fp parameter. The lower the --max-fp , the less chances of false positives matches on classification, but the larger the database size will be. For example, with --max-fp 0.01 the database will be build so any target (defined by --level ) will have 1 in a 100 change of reporting a false k-mer match. The false positive of the query (all k-mers of the reads) is higher but directly affected. Alternatively, one can set a specific size for the final index with --filter-size . When using this option, please observe the theoretic false positive of the index reported at the end of the building process. minimizers (--window-size, --kmer-size) :) in ganon build , when --window-size > --kmer-size minimizers are used. That means that for a every window, a single k-mer will be selected. It produces smaller database files and requires substantially less memory overall. It may increase building times but will have a huge benefit for classification times. Sensitivity and precision can be reduced by small margins. If --window-size = --kmer-size , all k-mers are going to be used to build the database. Target file or sequence (--input-target) :) Customized builds can be done either by file or sequence. --input-target file will consider every file provided with --input a single unit. --input-target sequence will use every sequence as a unit. --input-target file is the default behavior and most efficient way to build databases. --input-target sequence should only be used when the input sequences are stored in a single file or when classification at sequence level is desired. Build level (--level) :) The --level parameter defines the max. depth of the database for classification. This parameter is relevant because the --max-fp is going to be guaranteed at the --level chosen. By default, the level will be the same as --input-target , meaning that classification will be done either at file or sequence level. Alternatively, --level assembly will link the file or sequence target information with assembly accessions retrieved from NCBI servers. --level leaves or --level species (or genus, family, ...) will link the targets with taxonomic information and prune the tree at the chosen level. --level custom will use specialization level define in the --input-file . Genome sizes (--genome-size-files) :) Ganon will automatically download auxiliary files to define an approximate genome size for each entry in the taxonomic tree. For --taxonomy ncbi the species_genome_size.txt.gz is used. For --taxonomy gtdb the *_metadata.tar.gz files are used. Those files can be directly provided with the --genome-size-files argument. Genome sizes of parent nodes are calculated as the average of the respective children nodes. Other nodes without direct assigned genome sizes will use the closest parent with a pre-calculated genome size. The genome sizes are stored in the ganon database . Retrieving info (--ncbi-sequence-info, --ncbi-file-info) :) Further taxonomy and assembly linking information has to be collected to properly build the database. --ncbi-sequence-info and --ncbi-file-info allow customizations on this step. When --input-target sequence , --ncbi-sequence-info argument allows the use of NCBI e-utils webservices ( eutils ) or downloads accession2taxid files to extract target information (options nucl_gb nucl_wgs nucl_est nucl_gss pdb prot dead_nucl dead_wgs dead_prot ). By default, ganon uses eutils up-to 50000 input sequences, otherwise it downloads nucl_gb nucl_wgs from https://ftp.ncbi.nlm.nih.gov/pub/taxonomy/accession2taxid/. Previously downloaded files can be directly provided with this argument. When --input-target file , --ncbi-file-info uses assembly_summary.txt from https://ftp.ncbi.nlm.nih.gov/genomes/ to extract target information (options refseq genbank refseq_historical genbank_historical . Previously downloaded files can be directly provided with this argument. If you are using outdated, removed or inactive assembly or sequence files and accessions from NCBI, make sure to include dead_nucl dead_wgs for --ncbi-sequence-info or refseq_historical genbank_historical for --ncbi-file-info . eutils option does not work with outdated accessions.","title":"Custom databases (ganon build-custom)"},{"location":"custom_databases/#custom-databases","text":"","title":"Custom databases"},{"location":"custom_databases/#default-ncbi-assembly-or-sequence-accession","text":"Besides the automated download and build ( ganon build ) ganon provides a highly customizable build procedure ( ganon build-custom ) to create databases from local sequence files. To use custom sequences, just provide them with --input . ganon will try to retrieve all necessary information necessary to build a database. Note ganon expects assembly accessions in the filename like GCA_002211645.1_ASM221164v1_genomic.fna.gz . When using --input-target sequence filenames are not important but sequence headers should contain sequence accessions like >CP022124.1 Fusobacterium nu... . More information about building by file or sequence can be found here .","title":"Default NCBI assembly or sequence accession"},{"location":"custom_databases/#non-standardcustom-accessions","text":"It is also possible to use non-standard accessions and headers to build custom databases with --input-file . This file should contain the following fields (tab-separated): file [<tab> target <tab> node <tab> specialization <tab> specialization_name]. Note that file is mandatory and additional fields not. Tip If you just want to build a database without any taxonomic or target information, just sent the files with --input , use --taxonomy skip and choose between --input-target file or sequence . Examples of --input-file With --input-target file (default), where my_target_1 and my_target_2 are just names to assign sequences from (unique) sequence files: sequences.fasta my_target_1 others.fasta my_target_2 With --input-target sequence, second column should match sequence headers on provided sequence files (that should be repeated for each header): sequences.fasta HEADER1 sequences.fasta HEADER2 sequences.fasta HEADER3 others.fasta HEADER4 others.fasta HEADER5 A third column with taxonomic nodes can be provided to link the data with taxonomy. For example with --taxonomy ncbi: sequences.fasta FILE_A 562 others.fasta FILE_B 623 sequences.fasta HEADER1 562 sequences.fasta HEADER2 562 sequences.fasta HEADER3 562 others.fasta HEADER4 623 others.fasta HEADER5 623 Further specializations can be used to create a additional classification level after the taxonomic leaves. For example (using --level custom): sequences.fasta FILE_A 562 ID44444 Escherichia coli TW10119 others.fasta FILE_B 623 ID55555 Shigella flexneri 1a sequences.fasta HEADER1 562 ID443 Escherichia coli TW10119 sequences.fasta HEADER2 562 ID297 Escherichia coli PCN079 sequences.fasta HEADER3 562 ID8873 Escherichia coli P0301867.7 others.fasta HEADER4 623 ID2241 Shigella flexneri 1a others.fasta HEADER5 623 ID4422 Shigella flexneri 1b","title":"Non-standard/custom accessions"},{"location":"custom_databases/#examples","text":"Some examples with download and build commands for custom ganon databases from useful and commonly used repositories and datasets for metagenomics analysis:","title":"Examples"},{"location":"custom_databases/#humgut","text":"Collection of >30000 genomes from healthy human metagenomes. Article / Website . # Download sequence files wget --quiet --show-progress \"http://arken.nmbu.no/~larssn/humgut/HumGut.tar.gz\" tar xf HumGut.tar.gz # Download taxonomy and metadata files wget \"https://arken.nmbu.no/~larssn/humgut/ncbi_nodes.dmp\" wget \"https://arken.nmbu.no/~larssn/humgut/ncbi_names.dmp\" wget \"https://arken.nmbu.no/~larssn/humgut/HumGut.tsv\" # Generate --input-file from metadata tail -n+2 HumGut.tsv | awk -F\"\\t\" '{print \"fna/\"$21\"\\t\"$1\"\\t\"$2}' > HumGut_ganon_input_file.tsv # Build ganon database ganon build-custom --input-file HumGut_ganon_input_file.tsv --taxonomy-files ncbi_nodes.dmp ncbi_names.dmp --db-prefix HumGut --level strain --threads 32 Similarly using GTDB taxonomy files: # Download taxonomy files wget \"https://arken.nmbu.no/~larssn/humgut/gtdb_nodes.dmp\" wget \"https://arken.nmbu.no/~larssn/humgut/gtdb_names.dmp\" # Build ganon database ganon build-custom --input-file HumGut_ganon_input_file.tsv --taxonomy-files gtdb_nodes.dmp gtdb_names.dmp --db-prefix HumGut_gtdb --level strain --threads 32 Note There is no need to use ganon's gtdb integration here since GTDB files in NCBI format are available","title":"HumGut"},{"location":"custom_databases/#plasmid-plastid-and-mitochondrion-from-refseq","text":"Extra repositories from RefSeq release not included as default databases. Website . # Download sequence files wget -A genomic.fna.gz -m -nd --quiet --show-progress \"ftp://ftp.ncbi.nlm.nih.gov/genomes/refseq/plasmid/\" wget -A genomic.fna.gz -m -nd --quiet --show-progress \"ftp://ftp.ncbi.nlm.nih.gov/genomes/refseq/plastid/\" wget -A genomic.fna.gz -m -nd --quiet --show-progress \"ftp://ftp.ncbi.nlm.nih.gov/genomes/refseq/mitochondrion/\" # Build ganon database ganon build-custom --input plasmid.* plastid.* mitochondrion.* --db-prefix ppm --input-target sequence --level leaves --threads 32","title":"Plasmid, Plastid and Mitochondrion from RefSeq"},{"location":"custom_databases/#univec-univec_core","text":"\"UniVec is a non-redundant database of sequences commonly attached to cDNA or genomic DNA during the cloning process.\" Website . Useful to screen for vector and linker/adapter contamination. UniVec_core is a sub-set of the UniVec selected to reduce the false positive hits from real biological sources. # UniVec wget -O \"UniVec.fasta\" --quiet --show-progress \"ftp://ftp.ncbi.nlm.nih.gov/pub/UniVec/UniVec\" grep -o '^>[^ ]*' UniVec.fasta | sed 's/^>//' | awk '{print \"UniVec.fasta\\t\"$1\"\\t81077\"}' > UniVec_ganon_input_file.tsv ganon build-custom --input-file UniVec_ganon_input_file.tsv --db-prefix UniVec --input-target sequence --level leaves --threads 8 # UniVec_Core wget -O \"UniVec_Core.fasta\" --quiet --show-progress \"ftp://ftp.ncbi.nlm.nih.gov/pub/UniVec/UniVec_Core\" grep -o '^>[^ ]*' UniVec_Core.fasta | sed 's/^>//' | awk '{print \"UniVec_Core.fasta\\t\"$1\"\\t81077\"}' > UniVec_Core_ganon_input_file.tsv ganon build-custom --input-file UniVec_Core_ganon_input_file.tsv --db-prefix UniVec_Core --input-target sequence --level leaves --threads 8 Note All UniVec entries in the examples are categorized as Artificial Sequence (NCBI txid:81077). Some are completely artificial but others may be derived from real biological sources. More information in this link .","title":"UniVec, UniVec_core"},{"location":"custom_databases/#mgnify-genome-catalogues-mags","text":"\"Genome catalogues are biome-specific collections of metagenomic-assembled and isolate genomes\". Article / Website / FTP . There are currently (2023-05-04) 8 genome catalogues available: chicken-gut, human-gut, human-oral, marine, non-model-fish-gut, pig-gut and zebrafish-fecal. An example below how to download and build the human-oral catalog: # Download metadata wget \"https://ftp.ebi.ac.uk/pub/databases/metagenomics/mgnify_genomes/human-oral/v1.0/genomes-all_metadata.tsv\" # Download sequence files with 12 threads tail -n+2 genomes-all_metadata.tsv | cut -f 1,20 | xargs -P 12 -n2 sh -c 'curl --silent ${1}| gzip -d | sed -e \"1,/##FASTA/ d\" | gzip > ${0}.fna.gz' # Generate ganon input file tail -n+2 genomes-all_metadata.tsv | cut -f 1,15 | tr ';' '\\t' | awk -F\"\\t\" '{tax=\"1\";for(i=NF;i>1;i--){if(length($i)>3){tax=$i;break;}};print $1\".fna.gz\\t\"$1\"\\t\"tax}' > ganon_input_file.tsv # Build ganon database ganon build-custom --input-file ganon_input_file.tsv --db-prefix mgnify_human_oral_v1 --taxonomy gtdb --level leaves --threads 32 Note MGnify genomes catalogues will be build with GTDB taxonomy.","title":"MGnify genome catalogues (MAGs)"},{"location":"custom_databases/#pathogen-detection-fda-argos","text":"A collection of >1400 \"microbes that include biothreat microorganisms, common clinical pathogens and closely related species\". Article / Website / BioProject . # Download sequence files wget https://ftp.ncbi.nlm.nih.gov/genomes/refseq/assembly_summary_refseq.txt grep \"strain=FDAARGOS\" assembly_summary_refseq.txt > fdaargos_assembly_summary.txt genome_updater.sh -e fdaargos_assembly_summary.txt -f \"genomic.fna.gz\" -o download -m -t 12 # Build ganon database ganon build-custom --input download/ --input-recursive --db-prefix fdaargos --ncbi-file-info download/assembly_summary.txt --level assembly --threads 32 Note The example above uses genome_updater to download files","title":"Pathogen detection FDA-ARGOS"},{"location":"custom_databases/#blast-databases-nt-env_nt-nt_prok","text":"BLAST databases. Website / FTP . Current available nucleotide databases (2023-05-04): 16S_ribosomal_RNA 18S_fungal_sequences 28S_fungal_sequences Betacoronavirus env_nt human_genome ITS_eukaryote_sequences ITS_RefSeq_Fungi LSU_eukaryote_rRNA LSU_prokaryote_rRNA mito mouse_genome nt nt_euk nt_others nt_prok nt_viruses patnt pdbnt ref_euk_rep_genomes ref_prok_rep_genomes refseq_rna refseq_select_rna ref_viroids_rep_genomes ref_viruses_rep_genomes SSU_eukaryote_rRNA tsa_nt Note List currently available nucleotide databases curl --silent --list-only ftp://ftp.ncbi.nlm.nih.gov/blast/db/ | grep \"nucl-metadata.json\" | sed 's/-nucl-metadata.json/, /g' | sort Warning Some BLAST databases are very big and may require extreme computational resources to build. You may need to use some reduction strategies The example below extracts sequences and information from a BLAST db to build a ganon database: # Define BLAST db db=\"16S_ribosomal_RNA\" threads=8 # Download BLAST db - re-run this command many times until all finish (no more output) curl --silent --list-only ftp://ftp.ncbi.nlm.nih.gov/blast/db/ | grep \"^${db}\\..*tar.gz$\" | xargs -P ${threads:-1} -I{} wget --continue -nd --quiet --show-progress \"ftp://ftp.ncbi.nlm.nih.gov/blast/db/{}\" # OPTIONAL Download and check MD5 wget -O - -nd --quiet --show-progress \"ftp://ftp.ncbi.nlm.nih.gov/blast/db/${db}\\.*tar.gz.md5\" > \"${db}.md5\" md5sum \"${db}\".*tar.gz > \"${db}_downloaded.md5\" diff -s <(sort -k 2,2 \"${db}.md5\") <(sort -k 2,2 \"${db}_downloaded.md5\") # Should print \"Files /dev/fd/xx and /dev/fd/xx are identical\" # Extract BLAST db files, if successful, remove .tar.gz ls \"${db}\"*.tar.gz | xargs -P ${threads} -I{} sh -c 'gzip -dc {} | tar --overwrite -vxf - && rm {}' > \"${db}_extracted_files.txt\" # Create folder to write sequence files (split into 10 sub-folders) seq 0 9 | xargs -i mkdir -p \"${db}\"/{} # This command extracts sequences from the blastdb and writes them into taxid specific files # It also generates the --input-file for ganon blastdbcmd -entry all -db \"${db}\" -outfmt \"%a %T %s\" | \\ awk -v db=\"$(realpath ${db})\" '{file=db\"/\"substr($2,1,1)\"/\"$2\".fna\"; print \">\"$1\"\\n\"$3 >> file; print file\"\\t\"$2\"\\t\"$2}' | \\ sort | uniq > \"${db}_ganon_input_file.tsv\" # Build ganon database ganon build-custom --input-file \"${db}_ganon_input_file.tsv\" --db-prefix \"${db}\" --level species --threads 12 # Delete extracted files and auxiliary files cat \"${db}_extracted_files.txt\" | xargs rm rm \"${db}_extracted_files.txt\" \"${db}.md5\" \"${db}_downloaded.md5\" # Delete sequences rm -rf \"${db}\" \"${db}_ganon_input_file.tsv\" Note blastdbcmd is a command from BLAST software suite and should be installed separately","title":"BLAST databases (nt, env_nt, nt_prok, ...)"},{"location":"custom_databases/#files-from-genome_updater","text":"To create a ganon database from files previosly downloaded with genome_updater : ganon build-custom --input output_folder_genome_updater/version/ --input-recursive --db-prefix mydb --ncbi-file-info output_folder_genome_updater/assembly_summary.txt --level assembly --threads 32","title":"Files from genome_updater"},{"location":"custom_databases/#parameter-details","text":"","title":"Parameter details"},{"location":"custom_databases/#false-positive-and-size-max-fp-filter-size","text":"ganon indices are based on bloom filters and can have false positive matches. This can be controlled with --max-fp parameter. The lower the --max-fp , the less chances of false positives matches on classification, but the larger the database size will be. For example, with --max-fp 0.01 the database will be build so any target (defined by --level ) will have 1 in a 100 change of reporting a false k-mer match. The false positive of the query (all k-mers of the reads) is higher but directly affected. Alternatively, one can set a specific size for the final index with --filter-size . When using this option, please observe the theoretic false positive of the index reported at the end of the building process.","title":"False positive and size (--max-fp, --filter-size)"},{"location":"custom_databases/#minimizers-window-size-kmer-size","text":"in ganon build , when --window-size > --kmer-size minimizers are used. That means that for a every window, a single k-mer will be selected. It produces smaller database files and requires substantially less memory overall. It may increase building times but will have a huge benefit for classification times. Sensitivity and precision can be reduced by small margins. If --window-size = --kmer-size , all k-mers are going to be used to build the database.","title":"minimizers (--window-size, --kmer-size)"},{"location":"custom_databases/#target-file-or-sequence-input-target","text":"Customized builds can be done either by file or sequence. --input-target file will consider every file provided with --input a single unit. --input-target sequence will use every sequence as a unit. --input-target file is the default behavior and most efficient way to build databases. --input-target sequence should only be used when the input sequences are stored in a single file or when classification at sequence level is desired.","title":"Target file or sequence (--input-target)"},{"location":"custom_databases/#build-level-level","text":"The --level parameter defines the max. depth of the database for classification. This parameter is relevant because the --max-fp is going to be guaranteed at the --level chosen. By default, the level will be the same as --input-target , meaning that classification will be done either at file or sequence level. Alternatively, --level assembly will link the file or sequence target information with assembly accessions retrieved from NCBI servers. --level leaves or --level species (or genus, family, ...) will link the targets with taxonomic information and prune the tree at the chosen level. --level custom will use specialization level define in the --input-file .","title":"Build level (--level)"},{"location":"custom_databases/#genome-sizes-genome-size-files","text":"Ganon will automatically download auxiliary files to define an approximate genome size for each entry in the taxonomic tree. For --taxonomy ncbi the species_genome_size.txt.gz is used. For --taxonomy gtdb the *_metadata.tar.gz files are used. Those files can be directly provided with the --genome-size-files argument. Genome sizes of parent nodes are calculated as the average of the respective children nodes. Other nodes without direct assigned genome sizes will use the closest parent with a pre-calculated genome size. The genome sizes are stored in the ganon database .","title":"Genome sizes (--genome-size-files)"},{"location":"custom_databases/#retrieving-info-ncbi-sequence-info-ncbi-file-info","text":"Further taxonomy and assembly linking information has to be collected to properly build the database. --ncbi-sequence-info and --ncbi-file-info allow customizations on this step. When --input-target sequence , --ncbi-sequence-info argument allows the use of NCBI e-utils webservices ( eutils ) or downloads accession2taxid files to extract target information (options nucl_gb nucl_wgs nucl_est nucl_gss pdb prot dead_nucl dead_wgs dead_prot ). By default, ganon uses eutils up-to 50000 input sequences, otherwise it downloads nucl_gb nucl_wgs from https://ftp.ncbi.nlm.nih.gov/pub/taxonomy/accession2taxid/. Previously downloaded files can be directly provided with this argument. When --input-target file , --ncbi-file-info uses assembly_summary.txt from https://ftp.ncbi.nlm.nih.gov/genomes/ to extract target information (options refseq genbank refseq_historical genbank_historical . Previously downloaded files can be directly provided with this argument. If you are using outdated, removed or inactive assembly or sequence files and accessions from NCBI, make sure to include dead_nucl dead_wgs for --ncbi-sequence-info or refseq_historical genbank_historical for --ncbi-file-info . eutils option does not work with outdated accessions.","title":"Retrieving info (--ncbi-sequence-info, --ncbi-file-info)"},{"location":"default_databases/","text":"Databases :) ganon automates the download, update and build of databases based on NCBI RefSeq and GenBank genomes repositories wtih ganon build and update commands, for example: ganon build -g archaea bacteria -d arc_bac -c -t 30 will download archaeal and bacterial complete genomes from RefSeq and build a database with 30 threads. Some day later, the database can be updated to include newest genomes with: ganon update -d arc_bac -t 30 Additionally, custom databases can be built with customized files and identifiers with the ganon build-custom command. Info We DO NOT provide pre-built indices for download. ganon can build databases very efficiently. This way, you will always have up-to-date reference sequences and get most out of your data. Warning Databases are one of the most important elements when analyzing metagenomics data and should be chosen carefully based on the study data RefSeq and GenBank :) NCBI RefSeq and GenBank repositories are common resources to obtain reference sequences to analyze metagenomics data. They are mainly divided into domains/organism groups (e.g. archaea, bacteria, fungi, ...) but can be further filtered in many ways. The choice of those filters can drastically change the outcome of results. Commonly used sub-sets :) RefSeq # assemblies Size (GB) * Complete 295219 350 - 500 cmd ganon build --source refseq --organism-group archaea bacteria fungi viral --threads 48 --db-prefix abfv_rs One assembly per species 52779 40 - 98 cmd ganon build --source refseq --organism-group archaea bacteria fungi viral --threads 48 --genome-updater \"-A 'species:1'\" --db-prefix abfv_rs_t1s Complete genomes (higher quality) 44121 19 - 64 cmd ganon build --source refseq --organism-group archaea bacteria fungi viral --threads 48 --complete-genomes --db-prefix abfv_rs_cg One assembly per species of complete genomes 19713 8 - 27 cmd ganon build --source refseq --organism-group archaea bacteria fungi viral --threads 48 --complete-genomes \"-A 'species:1'\" --db-prefix abfv_rs_cg_t1s One representative assembly per species 18073 21 - 35 cmd ganon build --source refseq --organism-group archaea bacteria fungi viral --threads 48 --genome-updater \"-c 'representative genome'\" --db-prefix abfv_rs_rg GenBank # assemblies Size (GB) * Complete 1595845 cmd ganon build --source genbank --organism-group archaea bacteria fungi viral --threads 48 --db-prefix abfv_gb One assembly per species 99505 91 - 420 cmd ganon build --source genbank --organism-group archaea bacteria fungi viral --threads 48 --genome-updater \"-A 'species:1'\" --db-prefix abfv_gb_t1s Complete genomes (higher quality) 92917 24 - 132 cmd ganon build --source genbank --organism-group archaea bacteria fungi viral --threads 48 --complete-genomes --db-prefix abfv_gb_cg One assembly per species of complete genomes 34497 10 - 34 cmd ganon build --source genbank --organism-group archaea bacteria fungi viral --threads 48 --complete-genomes \"-A 'species:1'\" --db-prefix abfv_gb_cg_t1s * Size (GB) is the final size of the database and the approximate amount of RAM necessary to build it (calculated with default parameters). The two values represent databases built with and without the --hibf parameter, respectively. The trade-offs between those two modes are explained here . Warning The # assemblies were obtained on 2023-03-14 accounting for archaea, bacteria, fungi and viral groups only. By the time you are reading this, those numbers certainly grew a bit. As a rule of thumb, the more the better, so choose the most comprehensive sub-set as possible given your computational resources Databases can have a fixed size/RAM usage with the --filter-size parameter. Beware that smaller filters will increase the false positive rates when classifying. Other approaches can reduce the size/RAM requirements with some trade-offs . Further examples of commonly used database can be found here . Alternatively, you can build one database for each organism group separately and use them in ganon classify in any order or even stack them hierarchically. This way combination of multiple databases are possible, extending use cases. Tip assemblies usually represent strains and can be used to do \"strain-level classification\" Specific organisms or taxonomic groups :) It is also possible to generate databases for specific organisms or taxonomic branches with -a/--taxid , for example: ganon build --source refseq --taxid 562 317 --threads 48 --db-prefix coli_syringae will download and build a database for all Escherichia coli (taxid:562) and Pseudomonas syringae (taxid:317) assemblies from RefSeq. More filter options :) ganon uses genome_updater to manage downloads and further specific options and filters can be provided with the paramer -u/--genome-updater , for example: ganon build -g bacteria -t 48 -d bac_refseq --genome-updater \"-A 'genus:3' -E 20230101\" will download top 3 archaeal assemblies for each genus with date before 2023-01-01. For more information about genome_updater parameters, please check the repository . GTDB :) By default, ganon will use the NCBI Taxonomy to build the database. However, GTDB is fully supported and can be used with the parameter --taxonomy gtdb . GTDB R214 # assemblies Size (GB) Complete 402709 cmd ganon build --source refseq genbank --organism-group archaea bacteria --threads 48 --taxonomy gtdb --db-prefix ab_gtdb One assembly for each species 85205 cmd ganon build --source refseq genbank --organism-group archaea bacteria --threads 48 --taxonomy gtdb --top 1 --db-prefix ab_gtdb_t1s Filtering by taxonomic entries also work with GTDB, for example: ganon build --db-prefix fuso_gtdb --taxid \"f__Fusobacteriaceae\" --source refseq genbank --taxonomy gtdb --threads 12 Info GTDB covers only bacteria and archaea groups and has assemblies from both RefSeq and GenBank. Update (ganon update) :) Default ganon databases generated with the ganon build can be updated with ganon update . This procedure will download new files and re-generate the ganon database with the updated entries. For example, a database generated with the following command: ganon build --db-prefix arc_cg_rs --source refseq --organism-group archaea --complete-genomes --threads 12 will contain all archaeal complete genomes from NCBI RefSeq at the time of running. Some days later, the database can be updated, fetching only new sequences added to the NCBI repository with the command: ganon update --db-prefix arc_cg_rs --threads 12 Tip To not overwrite the current database and create a new one with the updated files, use the --output-db-prefix parameter. Reproducibility :) If you use ganon with default databases and want to re-generate it later or keep track of the content for reproducibility purposes, you can save the assembly_summary.txt file located inside the {output_prefix}_files/ directory. To re-download the exact same snapshot of files used, one could use genome_updater , for example: genome_updater.sh -e assembly_summary.txt -f \"genomic.fna.gz\" -o recovered_files -m -t 12 Reducing database size :) HIBF :) The Hierarchical Interleaved Bloom Filter (HIBF) is an improvement over the Interleaved Bloom Filter (IBF) and provides smaller databases with faster query times ( pre-print ). However, the HIBF takes longer to build and has less flexibility regarding size control. The HIBF can be generated in ganon build and ganon build-custom with the --hibf parameter. This is the best method to reduce large database sizes and to achieve faster classification speed. Hint For larger reference sets, huge amount of reads to query or production level analysis -> HIBF For quick build and analysis with smaller data -> IBF (default) Warning raptor (v3.0.0) has to be installed to build databases with --hibf Top assemblies :) RefSeq and GenBank are highly biased toward some few organisms. This means that some species are highly represented in number of assemblies compared to others. This can not only bias analysis but also brings redundancy to the database. Choosing a certain number of top assemblies can mitigate those issues. Database sizes can also be drastically reduced without this redundancy, but \"strain-level\" analysis are then not possible. We recommend using top assemblies for larger and comprehensive reference sets (like the ones listed above ) and use the full set of assemblies for specific clade analysis. Example ganon build --top 1 will select one assembly for each taxonomic leaf (NCBI taxonomy still has strain, sub-species, ...) ganon build --genome-updater \"-A 'species:1'\" will select one assembly for each species ganon build --genome-updater \"-A 'genus:3'\" will select three assemblies for each genus False positive :) A higher --max-fp value will generate a smaller database but with a higher number of false positive matches on classification. More details . Values between 0.01 and 0.3 are generally used. Fixed size :) A fixed size for the database filter can be defined with --filter-size . The smaller the filter size, the higher the false positive chances on classification. When using a fixed filter size, ganon will report the max. and avg. false positive rate at the end of the build. More details . Mode :) --mode offers 5 different categories to build a database controlling the trade-off between size and classification speed. avg : Balanced mode smaller or smallest : create smaller databases with slower classification speed fast or fastest : create bigger databases with faster classification speed Warning If --filter-size is used, smaller and smallest to the false positive and not to the database size which is fixed. Split databases :) Ganon allows classification with multiple databases in one level or in an hierarchy ( More details ). This means that databases can be built separately and used in any combination as desired. There are usually some benefits of doing so: Smaller databases when building by organism group, for example: one for bacteria, another for viruses, ... since average genome sizes are quite different. Easier to maintain and update. Extend use cases and avoid misclassification due to contaminated databases. Use databases as quality control, for example: remove reads matching one database of host or vectors (check out ganon report --skip-hierarchy ). k-mer and window size :) Define how much unique information is stored in the database. More details The smaller the --kmer-size , the less unique they will be, reducing database size but also sensitivity in classification. The bigger the --window-size , the less information needs to be stored resulting in smaller databases but with decrease classification accuracy. Example :) Besides the huge benefits of using HIBF and specific sub-sets of big repositories shown on the default databases table , examples of other reduction strategies (without --hibf ) can be seen below: RefSeq archaeal complete genomes from 20230505 Strategy Size (MB) Smaller Trade-off default 318 - - cmd ganon build --source refseq --organism-group archaea --threads 12 --complete-genomes --db-prefix arc_rs_cg --mode smallest 301 5% Slower classification cmd ganon build --source refseq --organism-group archaea --threads 12 --complete-genomes --mode smallest --db-prefix arc_rs_cg_smallest --filter-size 256 256 19% Higher false positive on classification cmd ganon build --source refseq --organism-group archaea --threads 12 --complete-genomes --filter-size 256 --db-prefix arc_rs_cg_fs256 --window-size 35 249 21% Less sensitive classification cmd ganon build --source refseq --organism-group archaea --threads 12 --complete-genomes --window-size 35 --db-prefix arc_rs_cg_ws35 --max-fp 0.2 190 40% Higher false positive on classification cmd ganon build --source refseq --organism-group archaea --threads 12 --complete-genomes --max-fp 0.2 --db-prefix arc_rs_cg_fp0.2 Note This is an illustrative example and the reduction proportions for different configuration may be quite different","title":"Databases (ganon build)"},{"location":"default_databases/#databases","text":"ganon automates the download, update and build of databases based on NCBI RefSeq and GenBank genomes repositories wtih ganon build and update commands, for example: ganon build -g archaea bacteria -d arc_bac -c -t 30 will download archaeal and bacterial complete genomes from RefSeq and build a database with 30 threads. Some day later, the database can be updated to include newest genomes with: ganon update -d arc_bac -t 30 Additionally, custom databases can be built with customized files and identifiers with the ganon build-custom command. Info We DO NOT provide pre-built indices for download. ganon can build databases very efficiently. This way, you will always have up-to-date reference sequences and get most out of your data. Warning Databases are one of the most important elements when analyzing metagenomics data and should be chosen carefully based on the study data","title":"Databases"},{"location":"default_databases/#refseq-and-genbank","text":"NCBI RefSeq and GenBank repositories are common resources to obtain reference sequences to analyze metagenomics data. They are mainly divided into domains/organism groups (e.g. archaea, bacteria, fungi, ...) but can be further filtered in many ways. The choice of those filters can drastically change the outcome of results.","title":"RefSeq and GenBank"},{"location":"default_databases/#commonly-used-sub-sets","text":"RefSeq # assemblies Size (GB) * Complete 295219 350 - 500 cmd ganon build --source refseq --organism-group archaea bacteria fungi viral --threads 48 --db-prefix abfv_rs One assembly per species 52779 40 - 98 cmd ganon build --source refseq --organism-group archaea bacteria fungi viral --threads 48 --genome-updater \"-A 'species:1'\" --db-prefix abfv_rs_t1s Complete genomes (higher quality) 44121 19 - 64 cmd ganon build --source refseq --organism-group archaea bacteria fungi viral --threads 48 --complete-genomes --db-prefix abfv_rs_cg One assembly per species of complete genomes 19713 8 - 27 cmd ganon build --source refseq --organism-group archaea bacteria fungi viral --threads 48 --complete-genomes \"-A 'species:1'\" --db-prefix abfv_rs_cg_t1s One representative assembly per species 18073 21 - 35 cmd ganon build --source refseq --organism-group archaea bacteria fungi viral --threads 48 --genome-updater \"-c 'representative genome'\" --db-prefix abfv_rs_rg GenBank # assemblies Size (GB) * Complete 1595845 cmd ganon build --source genbank --organism-group archaea bacteria fungi viral --threads 48 --db-prefix abfv_gb One assembly per species 99505 91 - 420 cmd ganon build --source genbank --organism-group archaea bacteria fungi viral --threads 48 --genome-updater \"-A 'species:1'\" --db-prefix abfv_gb_t1s Complete genomes (higher quality) 92917 24 - 132 cmd ganon build --source genbank --organism-group archaea bacteria fungi viral --threads 48 --complete-genomes --db-prefix abfv_gb_cg One assembly per species of complete genomes 34497 10 - 34 cmd ganon build --source genbank --organism-group archaea bacteria fungi viral --threads 48 --complete-genomes \"-A 'species:1'\" --db-prefix abfv_gb_cg_t1s * Size (GB) is the final size of the database and the approximate amount of RAM necessary to build it (calculated with default parameters). The two values represent databases built with and without the --hibf parameter, respectively. The trade-offs between those two modes are explained here . Warning The # assemblies were obtained on 2023-03-14 accounting for archaea, bacteria, fungi and viral groups only. By the time you are reading this, those numbers certainly grew a bit. As a rule of thumb, the more the better, so choose the most comprehensive sub-set as possible given your computational resources Databases can have a fixed size/RAM usage with the --filter-size parameter. Beware that smaller filters will increase the false positive rates when classifying. Other approaches can reduce the size/RAM requirements with some trade-offs . Further examples of commonly used database can be found here . Alternatively, you can build one database for each organism group separately and use them in ganon classify in any order or even stack them hierarchically. This way combination of multiple databases are possible, extending use cases. Tip assemblies usually represent strains and can be used to do \"strain-level classification\"","title":"Commonly used sub-sets"},{"location":"default_databases/#specific-organisms-or-taxonomic-groups","text":"It is also possible to generate databases for specific organisms or taxonomic branches with -a/--taxid , for example: ganon build --source refseq --taxid 562 317 --threads 48 --db-prefix coli_syringae will download and build a database for all Escherichia coli (taxid:562) and Pseudomonas syringae (taxid:317) assemblies from RefSeq.","title":"Specific organisms or taxonomic groups"},{"location":"default_databases/#more-filter-options","text":"ganon uses genome_updater to manage downloads and further specific options and filters can be provided with the paramer -u/--genome-updater , for example: ganon build -g bacteria -t 48 -d bac_refseq --genome-updater \"-A 'genus:3' -E 20230101\" will download top 3 archaeal assemblies for each genus with date before 2023-01-01. For more information about genome_updater parameters, please check the repository .","title":"More filter options"},{"location":"default_databases/#gtdb","text":"By default, ganon will use the NCBI Taxonomy to build the database. However, GTDB is fully supported and can be used with the parameter --taxonomy gtdb . GTDB R214 # assemblies Size (GB) Complete 402709 cmd ganon build --source refseq genbank --organism-group archaea bacteria --threads 48 --taxonomy gtdb --db-prefix ab_gtdb One assembly for each species 85205 cmd ganon build --source refseq genbank --organism-group archaea bacteria --threads 48 --taxonomy gtdb --top 1 --db-prefix ab_gtdb_t1s Filtering by taxonomic entries also work with GTDB, for example: ganon build --db-prefix fuso_gtdb --taxid \"f__Fusobacteriaceae\" --source refseq genbank --taxonomy gtdb --threads 12 Info GTDB covers only bacteria and archaea groups and has assemblies from both RefSeq and GenBank.","title":"GTDB"},{"location":"default_databases/#update-ganon-update","text":"Default ganon databases generated with the ganon build can be updated with ganon update . This procedure will download new files and re-generate the ganon database with the updated entries. For example, a database generated with the following command: ganon build --db-prefix arc_cg_rs --source refseq --organism-group archaea --complete-genomes --threads 12 will contain all archaeal complete genomes from NCBI RefSeq at the time of running. Some days later, the database can be updated, fetching only new sequences added to the NCBI repository with the command: ganon update --db-prefix arc_cg_rs --threads 12 Tip To not overwrite the current database and create a new one with the updated files, use the --output-db-prefix parameter.","title":"Update (ganon update)"},{"location":"default_databases/#reproducibility","text":"If you use ganon with default databases and want to re-generate it later or keep track of the content for reproducibility purposes, you can save the assembly_summary.txt file located inside the {output_prefix}_files/ directory. To re-download the exact same snapshot of files used, one could use genome_updater , for example: genome_updater.sh -e assembly_summary.txt -f \"genomic.fna.gz\" -o recovered_files -m -t 12","title":"Reproducibility"},{"location":"default_databases/#reducing-database-size","text":"","title":"Reducing database size"},{"location":"default_databases/#hibf","text":"The Hierarchical Interleaved Bloom Filter (HIBF) is an improvement over the Interleaved Bloom Filter (IBF) and provides smaller databases with faster query times ( pre-print ). However, the HIBF takes longer to build and has less flexibility regarding size control. The HIBF can be generated in ganon build and ganon build-custom with the --hibf parameter. This is the best method to reduce large database sizes and to achieve faster classification speed. Hint For larger reference sets, huge amount of reads to query or production level analysis -> HIBF For quick build and analysis with smaller data -> IBF (default) Warning raptor (v3.0.0) has to be installed to build databases with --hibf","title":"HIBF"},{"location":"default_databases/#top-assemblies","text":"RefSeq and GenBank are highly biased toward some few organisms. This means that some species are highly represented in number of assemblies compared to others. This can not only bias analysis but also brings redundancy to the database. Choosing a certain number of top assemblies can mitigate those issues. Database sizes can also be drastically reduced without this redundancy, but \"strain-level\" analysis are then not possible. We recommend using top assemblies for larger and comprehensive reference sets (like the ones listed above ) and use the full set of assemblies for specific clade analysis. Example ganon build --top 1 will select one assembly for each taxonomic leaf (NCBI taxonomy still has strain, sub-species, ...) ganon build --genome-updater \"-A 'species:1'\" will select one assembly for each species ganon build --genome-updater \"-A 'genus:3'\" will select three assemblies for each genus","title":"Top assemblies"},{"location":"default_databases/#false-positive","text":"A higher --max-fp value will generate a smaller database but with a higher number of false positive matches on classification. More details . Values between 0.01 and 0.3 are generally used.","title":"False positive"},{"location":"default_databases/#fixed-size","text":"A fixed size for the database filter can be defined with --filter-size . The smaller the filter size, the higher the false positive chances on classification. When using a fixed filter size, ganon will report the max. and avg. false positive rate at the end of the build. More details .","title":"Fixed size"},{"location":"default_databases/#mode","text":"--mode offers 5 different categories to build a database controlling the trade-off between size and classification speed. avg : Balanced mode smaller or smallest : create smaller databases with slower classification speed fast or fastest : create bigger databases with faster classification speed Warning If --filter-size is used, smaller and smallest to the false positive and not to the database size which is fixed.","title":"Mode"},{"location":"default_databases/#split-databases","text":"Ganon allows classification with multiple databases in one level or in an hierarchy ( More details ). This means that databases can be built separately and used in any combination as desired. There are usually some benefits of doing so: Smaller databases when building by organism group, for example: one for bacteria, another for viruses, ... since average genome sizes are quite different. Easier to maintain and update. Extend use cases and avoid misclassification due to contaminated databases. Use databases as quality control, for example: remove reads matching one database of host or vectors (check out ganon report --skip-hierarchy ).","title":"Split databases"},{"location":"default_databases/#k-mer-and-window-size","text":"Define how much unique information is stored in the database. More details The smaller the --kmer-size , the less unique they will be, reducing database size but also sensitivity in classification. The bigger the --window-size , the less information needs to be stored resulting in smaller databases but with decrease classification accuracy.","title":"k-mer and window size"},{"location":"default_databases/#example","text":"Besides the huge benefits of using HIBF and specific sub-sets of big repositories shown on the default databases table , examples of other reduction strategies (without --hibf ) can be seen below: RefSeq archaeal complete genomes from 20230505 Strategy Size (MB) Smaller Trade-off default 318 - - cmd ganon build --source refseq --organism-group archaea --threads 12 --complete-genomes --db-prefix arc_rs_cg --mode smallest 301 5% Slower classification cmd ganon build --source refseq --organism-group archaea --threads 12 --complete-genomes --mode smallest --db-prefix arc_rs_cg_smallest --filter-size 256 256 19% Higher false positive on classification cmd ganon build --source refseq --organism-group archaea --threads 12 --complete-genomes --filter-size 256 --db-prefix arc_rs_cg_fs256 --window-size 35 249 21% Less sensitive classification cmd ganon build --source refseq --organism-group archaea --threads 12 --complete-genomes --window-size 35 --db-prefix arc_rs_cg_ws35 --max-fp 0.2 190 40% Higher false positive on classification cmd ganon build --source refseq --organism-group archaea --threads 12 --complete-genomes --max-fp 0.2 --db-prefix arc_rs_cg_fp0.2 Note This is an illustrative example and the reduction proportions for different configuration may be quite different","title":"Example"},{"location":"outputfiles/","text":"Output files :) ganon build/build-custom/update :) Every run on ganon build , ganon build-custom or ganon update will generate the following database files: {prefix} .ibf/.hibf : main interleaved bloom filter index file, .hibf is generated with --hibf option. {prefix} .tax : taxonomy tree, only generated if --taxonomy is used (fields: target/node, parent, rank, name, genome size) . {prefix} _files/ : ( ganon build only) folder containing downloaded reference sequence and auxiliary files. Not necessary for classification. Keep this folder if the database will be update later. Otherwise it can be deleted. Warning Database files generated with version 1.2.0 or higher are not compatible with older versions. ganon classify :) {prefix} .tre : full report file (see below) {prefix} .rep : plain report of the run with only targets that received a match. Can be used to re-generate full reports (.tre) with ganon report . At the end prints 2 extra lines with #total_classified and #total_unclassified . Fields 1: hierarchy label 2: target 3: # total matches 4: # unique reads 5: # lca reads 6: rank 7: name {prefix} .lca : output with one match for each classified read after LCA. Only generated with --output-lca active. If multiple hierarchy levels are set, one file for each level will be created: {prefix}.{hierarchy}.lca (fields: read identifier, target, (max) k-mer/minimizer count) {prefix} .all : output with all matches for each read. Only generated with --output-all active Warning: file can be very large . If multiple hierarchy levels are set, one file for each level will be created: {prefix}.{hierarchy}.all (fields: read identifier, target, k-mer/minimizer count) ganon report :) {prefix} .tre : tab-separated tree-like report with cumulative counts and taxonomic lineage. There are several possible --report-type . More information on the different types of reports can be found here : abundance : will attempt to estimate taxonomic abundances by re-disributing read counts from LCA matches and correcting sequence abundance by approximate genome sizes. reads : sequence abundances , reports the proportion of sequences assigned to a taxa, each read classified is counted once. dist : like reads with read count re-distribution. corr : like reads with correction by genome size. matches : every match is reported to their original target, including multiple and shared matches. Each line in this report is a taxonomic entry (including the root node), with the following fields: col field obs example 1 rank phylum 2 target taxonomic id. or specialization (assembly id.) 562 3 lineage 1|131567|2|1224|28211|766|942|768|769 4 name Chromobacterium rhizoryzae 5 # unique number of reads that matched exclusively to this target 5 6 # shared number of reads with non-unique matches directly assigned to this target. Represents the LCA matches ( --report-type reads ), re-assigned matches ( --report-type abundance/dist ) or shared matches ( --report-type matches ) 10 7 # children number of unique and shared assignments to all children nodes of this target 20 8 # cumulative the sum of the unique, shared and children assignments up-to this target 35 9 % cumulative percentage of assignments or estimated relative abundance for --report-type abundance 43.24 The first line of the report file will show the number of unclassified reads (not for --report-type matches ) The CAMI challenge bioboxes profiling format is supported using --output-format bioboxes . In this format, only values for the percentage/abundance (col. 9) are reported. The root node and unclassified entries are ommited. The sum of cumulative assignments for the unclassified and root lines is 100%. The final cumulative sum of reads/matches may be under 100% if any filter is successfully applied and/or hierarchical selection is selected (keep/skip/split). For all report type but matches , only taxa that received direct read matches, either unique or by LCA assignment, are considered. Some reads may have only shared matches and will not be reported directly but will be accounted for on some parent level. To visualize those matches, create a report with --report-type matches or use directly the file {prefix} .rep . ganon table :) {output_file}: a tab-separated file with counts/percentages of taxa for multiple samples Examples of output files The main output file is the `{prefix}.tre` which will summarize the results: unclassified unclassified 0 0 0 2 2.02020 root 1 1 root 0 0 97 97 97.97980 superkingdom 2 1|2 Bacteria 0 0 97 97 97.97980 phylum 1239 1|2|1239 Firmicutes 0 0 57 57 57.57576 phylum 1224 1|2|1224 Proteobacteria 0 0 40 40 40.40404 class 91061 1|2|1239|91061 Bacilli 0 0 57 57 57.57576 class 28211 1|2|1224|28211 Alphaproteobacteria 0 0 28 28 28.28283 class 1236 1|2|1224|1236 Gammaproteobacteria 0 0 12 12 12.12121 order 1385 1|2|1239|91061|1385 Bacillales 0 0 57 57 57.57576 order 204458 1|2|1224|28211|204458 Caulobacterales 0 0 28 28 28.28283 order 72274 1|2|1224|1236|72274 Pseudomonadales 0 0 12 12 12.12121 family 186822 1|2|1239|91061|1385|186822 Paenibacillaceae 0 0 57 57 57.57576 family 76892 1|2|1224|28211|204458|76892 Caulobacteraceae 0 0 28 28 28.28283 family 468 1|2|1224|1236|72274|468 Moraxellaceae 0 0 12 12 12.12121 genus 44249 1|2|1239|91061|1385|186822|44249 Paenibacillus 0 0 57 57 57.57576 genus 75 1|2|1224|28211|204458|76892|75 Caulobacter 0 0 28 28 28.28283 genus 469 1|2|1224|1236|72274|468|469 Acinetobacter 0 0 12 12 12.12121 species 1406 1|2|1239|91061|1385|186822|44249|1406 Paenibacillus polymyxa 57 0 0 57 57.57576 species 366602 1|2|1224|28211|204458|76892|75|366602 Caulobacter sp. K31 28 0 0 28 28.28283 species 470 1|2|1224|1236|72274|468|469|470 Acinetobacter baumannii 12 0 0 12 12.12121 running `ganon classify` or `ganon report` with `--ranks all`, the output will show all ranks used for classification and presented sorted by lineage (also available with `ganon report --sort lineage`): unclassified unclassified 0 0 0 2 2.02020 root 1 1 root 0 0 97 97 97.97980 no rank 131567 1|131567 cellular organisms 0 0 97 97 97.97980 superkingdom 2 1|131567|2 Bacteria 0 0 97 97 97.97980 phylum 1224 1|131567|2|1224 Proteobacteria 0 0 40 40 40.40404 class 1236 1|131567|2|1224|1236 Gammaproteobacteria 0 0 12 12 12.12121 order 72274 1|131567|2|1224|1236|72274 Pseudomonadales 0 0 12 12 12.12121 family 468 1|131567|2|1224|1236|72274|468 Moraxellaceae 0 0 12 12 12.12121 genus 469 1|131567|2|1224|1236|72274|468|469 Acinetobacter 0 0 12 12 12.12121 species group 909768 1|131567|2|1224|1236|72274|468|469|909768 Acinetobacter calcoaceticus/baumannii complex 0 0 12 12 12.12121 species 470 1|131567|2|1224|1236|72274|468|469|909768|470 Acinetobacter baumannii 12 0 0 12 12.12121 class 28211 1|131567|2|1224|28211 Alphaproteobacteria 0 0 28 28 28.28283 order 204458 1|131567|2|1224|28211|204458 Caulobacterales 0 0 28 28 28.28283 family 76892 1|131567|2|1224|28211|204458|76892 Caulobacteraceae 0 0 28 28 28.28283 genus 75 1|131567|2|1224|28211|204458|76892|75 Caulobacter 0 0 28 28 28.28283 species 366602 1|131567|2|1224|28211|204458|76892|75|366602 Caulobacter sp. K31 28 0 0 28 28.28283 no rank 1783272 1|131567|2|1783272 Terrabacteria group 0 0 57 57 57.57576 phylum 1239 1|131567|2|1783272|1239 Firmicutes 0 0 57 57 57.57576 class 91061 1|131567|2|1783272|1239|91061 Bacilli 0 0 57 57 57.57576 order 1385 1|131567|2|1783272|1239|91061|1385 Bacillales 0 0 57 57 57.57576 family 186822 1|131567|2|1783272|1239|91061|1385|186822 Paenibacillaceae 0 0 57 57 57.57576 genus 44249 1|131567|2|1783272|1239|91061|1385|186822|44249 Paenibacillus 0 0 57 57 57.57576 species 1406 1|131567|2|1783272|1239|91061|1385|186822|44249|1406 Paenibacillus polymyxa 57 0 0 57 57.57576 with `--output-format bioboxes` @Version:0.10.0 @SampleID:example.rep H1 @Ranks:superkingdom|phylum|class|order|family|genus|species|assembly @Taxonomy:db.tax @@TAXID RANK TAXPATH TAXPATHSN PERCENTAGE 2 superkingdom 2 Bacteria 100.00000 1224 phylum 2|1224 Bacteria|Proteobacteria 56.89782 201174 phylum 2|201174 Bacteria|Actinobacteria 21.84869 1239 phylum 2|1239 Bacteria|Firmicutes 9.75197 976 phylum 2|976 Bacteria|Bacteroidota 6.15297 1117 phylum 2|1117 Bacteria|Cyanobacteria 2.23146 203682 phylum 2|203682 Bacteria|Planctomycetota 1.23353 57723 phylum 2|57723 Bacteria|Acidobacteria 0.52549 200795 phylum 2|200795 Bacteria|Chloroflexi 0.31118","title":"Output files"},{"location":"outputfiles/#output-files","text":"","title":"Output files"},{"location":"outputfiles/#ganon-buildbuild-customupdate","text":"Every run on ganon build , ganon build-custom or ganon update will generate the following database files: {prefix} .ibf/.hibf : main interleaved bloom filter index file, .hibf is generated with --hibf option. {prefix} .tax : taxonomy tree, only generated if --taxonomy is used (fields: target/node, parent, rank, name, genome size) . {prefix} _files/ : ( ganon build only) folder containing downloaded reference sequence and auxiliary files. Not necessary for classification. Keep this folder if the database will be update later. Otherwise it can be deleted. Warning Database files generated with version 1.2.0 or higher are not compatible with older versions.","title":"ganon build/build-custom/update"},{"location":"outputfiles/#ganon-classify","text":"{prefix} .tre : full report file (see below) {prefix} .rep : plain report of the run with only targets that received a match. Can be used to re-generate full reports (.tre) with ganon report . At the end prints 2 extra lines with #total_classified and #total_unclassified . Fields 1: hierarchy label 2: target 3: # total matches 4: # unique reads 5: # lca reads 6: rank 7: name {prefix} .lca : output with one match for each classified read after LCA. Only generated with --output-lca active. If multiple hierarchy levels are set, one file for each level will be created: {prefix}.{hierarchy}.lca (fields: read identifier, target, (max) k-mer/minimizer count) {prefix} .all : output with all matches for each read. Only generated with --output-all active Warning: file can be very large . If multiple hierarchy levels are set, one file for each level will be created: {prefix}.{hierarchy}.all (fields: read identifier, target, k-mer/minimizer count)","title":"ganon classify"},{"location":"outputfiles/#ganon-report","text":"{prefix} .tre : tab-separated tree-like report with cumulative counts and taxonomic lineage. There are several possible --report-type . More information on the different types of reports can be found here : abundance : will attempt to estimate taxonomic abundances by re-disributing read counts from LCA matches and correcting sequence abundance by approximate genome sizes. reads : sequence abundances , reports the proportion of sequences assigned to a taxa, each read classified is counted once. dist : like reads with read count re-distribution. corr : like reads with correction by genome size. matches : every match is reported to their original target, including multiple and shared matches. Each line in this report is a taxonomic entry (including the root node), with the following fields: col field obs example 1 rank phylum 2 target taxonomic id. or specialization (assembly id.) 562 3 lineage 1|131567|2|1224|28211|766|942|768|769 4 name Chromobacterium rhizoryzae 5 # unique number of reads that matched exclusively to this target 5 6 # shared number of reads with non-unique matches directly assigned to this target. Represents the LCA matches ( --report-type reads ), re-assigned matches ( --report-type abundance/dist ) or shared matches ( --report-type matches ) 10 7 # children number of unique and shared assignments to all children nodes of this target 20 8 # cumulative the sum of the unique, shared and children assignments up-to this target 35 9 % cumulative percentage of assignments or estimated relative abundance for --report-type abundance 43.24 The first line of the report file will show the number of unclassified reads (not for --report-type matches ) The CAMI challenge bioboxes profiling format is supported using --output-format bioboxes . In this format, only values for the percentage/abundance (col. 9) are reported. The root node and unclassified entries are ommited. The sum of cumulative assignments for the unclassified and root lines is 100%. The final cumulative sum of reads/matches may be under 100% if any filter is successfully applied and/or hierarchical selection is selected (keep/skip/split). For all report type but matches , only taxa that received direct read matches, either unique or by LCA assignment, are considered. Some reads may have only shared matches and will not be reported directly but will be accounted for on some parent level. To visualize those matches, create a report with --report-type matches or use directly the file {prefix} .rep .","title":"ganon report"},{"location":"outputfiles/#ganon-table","text":"{output_file}: a tab-separated file with counts/percentages of taxa for multiple samples Examples of output files The main output file is the `{prefix}.tre` which will summarize the results: unclassified unclassified 0 0 0 2 2.02020 root 1 1 root 0 0 97 97 97.97980 superkingdom 2 1|2 Bacteria 0 0 97 97 97.97980 phylum 1239 1|2|1239 Firmicutes 0 0 57 57 57.57576 phylum 1224 1|2|1224 Proteobacteria 0 0 40 40 40.40404 class 91061 1|2|1239|91061 Bacilli 0 0 57 57 57.57576 class 28211 1|2|1224|28211 Alphaproteobacteria 0 0 28 28 28.28283 class 1236 1|2|1224|1236 Gammaproteobacteria 0 0 12 12 12.12121 order 1385 1|2|1239|91061|1385 Bacillales 0 0 57 57 57.57576 order 204458 1|2|1224|28211|204458 Caulobacterales 0 0 28 28 28.28283 order 72274 1|2|1224|1236|72274 Pseudomonadales 0 0 12 12 12.12121 family 186822 1|2|1239|91061|1385|186822 Paenibacillaceae 0 0 57 57 57.57576 family 76892 1|2|1224|28211|204458|76892 Caulobacteraceae 0 0 28 28 28.28283 family 468 1|2|1224|1236|72274|468 Moraxellaceae 0 0 12 12 12.12121 genus 44249 1|2|1239|91061|1385|186822|44249 Paenibacillus 0 0 57 57 57.57576 genus 75 1|2|1224|28211|204458|76892|75 Caulobacter 0 0 28 28 28.28283 genus 469 1|2|1224|1236|72274|468|469 Acinetobacter 0 0 12 12 12.12121 species 1406 1|2|1239|91061|1385|186822|44249|1406 Paenibacillus polymyxa 57 0 0 57 57.57576 species 366602 1|2|1224|28211|204458|76892|75|366602 Caulobacter sp. K31 28 0 0 28 28.28283 species 470 1|2|1224|1236|72274|468|469|470 Acinetobacter baumannii 12 0 0 12 12.12121 running `ganon classify` or `ganon report` with `--ranks all`, the output will show all ranks used for classification and presented sorted by lineage (also available with `ganon report --sort lineage`): unclassified unclassified 0 0 0 2 2.02020 root 1 1 root 0 0 97 97 97.97980 no rank 131567 1|131567 cellular organisms 0 0 97 97 97.97980 superkingdom 2 1|131567|2 Bacteria 0 0 97 97 97.97980 phylum 1224 1|131567|2|1224 Proteobacteria 0 0 40 40 40.40404 class 1236 1|131567|2|1224|1236 Gammaproteobacteria 0 0 12 12 12.12121 order 72274 1|131567|2|1224|1236|72274 Pseudomonadales 0 0 12 12 12.12121 family 468 1|131567|2|1224|1236|72274|468 Moraxellaceae 0 0 12 12 12.12121 genus 469 1|131567|2|1224|1236|72274|468|469 Acinetobacter 0 0 12 12 12.12121 species group 909768 1|131567|2|1224|1236|72274|468|469|909768 Acinetobacter calcoaceticus/baumannii complex 0 0 12 12 12.12121 species 470 1|131567|2|1224|1236|72274|468|469|909768|470 Acinetobacter baumannii 12 0 0 12 12.12121 class 28211 1|131567|2|1224|28211 Alphaproteobacteria 0 0 28 28 28.28283 order 204458 1|131567|2|1224|28211|204458 Caulobacterales 0 0 28 28 28.28283 family 76892 1|131567|2|1224|28211|204458|76892 Caulobacteraceae 0 0 28 28 28.28283 genus 75 1|131567|2|1224|28211|204458|76892|75 Caulobacter 0 0 28 28 28.28283 species 366602 1|131567|2|1224|28211|204458|76892|75|366602 Caulobacter sp. K31 28 0 0 28 28.28283 no rank 1783272 1|131567|2|1783272 Terrabacteria group 0 0 57 57 57.57576 phylum 1239 1|131567|2|1783272|1239 Firmicutes 0 0 57 57 57.57576 class 91061 1|131567|2|1783272|1239|91061 Bacilli 0 0 57 57 57.57576 order 1385 1|131567|2|1783272|1239|91061|1385 Bacillales 0 0 57 57 57.57576 family 186822 1|131567|2|1783272|1239|91061|1385|186822 Paenibacillaceae 0 0 57 57 57.57576 genus 44249 1|131567|2|1783272|1239|91061|1385|186822|44249 Paenibacillus 0 0 57 57 57.57576 species 1406 1|131567|2|1783272|1239|91061|1385|186822|44249|1406 Paenibacillus polymyxa 57 0 0 57 57.57576 with `--output-format bioboxes` @Version:0.10.0 @SampleID:example.rep H1 @Ranks:superkingdom|phylum|class|order|family|genus|species|assembly @Taxonomy:db.tax @@TAXID RANK TAXPATH TAXPATHSN PERCENTAGE 2 superkingdom 2 Bacteria 100.00000 1224 phylum 2|1224 Bacteria|Proteobacteria 56.89782 201174 phylum 2|201174 Bacteria|Actinobacteria 21.84869 1239 phylum 2|1239 Bacteria|Firmicutes 9.75197 976 phylum 2|976 Bacteria|Bacteroidota 6.15297 1117 phylum 2|1117 Bacteria|Cyanobacteria 2.23146 203682 phylum 2|203682 Bacteria|Planctomycetota 1.23353 57723 phylum 2|57723 Bacteria|Acidobacteria 0.52549 200795 phylum 2|200795 Bacteria|Chloroflexi 0.31118","title":"ganon table"},{"location":"reports/","text":"Reports :) Parameter details :) report type (--report-type) :) Several reports are availble with --report-type : reads , abundance , dist , corr , matches : reads reports sequence abundances which are the basic proportion of reads classified in the sample. abundance will convert sequence abundance into taxonomic abundances by re-distributing read counts among leaf nodes and correcting by genome size. The re-distribution applies for reads classified with a LCA assignment and it is proportional to the number of unique matches of leaf nodes available in the ganon database (relative to the LCA node). Genome size is estimated based on NCBI or GTDB auxiliary files . Genome size correction is applied by rank based on default ranks only (superkingdom phylum class order family genus species assembly). Read counts in intermediate ranks will be corrected based on the closest parent default rank and re-assigned to its original rank. dist is the same of reads with read count re-distribution corr is the same of reads with correction by genome size matches will report the total number of matches classified, either unique or shared. This report will output the total number of matches instead the total number of reads reported in all other reports.","title":"Reports (ganon report)"},{"location":"reports/#reports","text":"","title":"Reports"},{"location":"reports/#parameter-details","text":"","title":"Parameter details"},{"location":"reports/#report-type-report-type","text":"Several reports are availble with --report-type : reads , abundance , dist , corr , matches : reads reports sequence abundances which are the basic proportion of reads classified in the sample. abundance will convert sequence abundance into taxonomic abundances by re-distributing read counts among leaf nodes and correcting by genome size. The re-distribution applies for reads classified with a LCA assignment and it is proportional to the number of unique matches of leaf nodes available in the ganon database (relative to the LCA node). Genome size is estimated based on NCBI or GTDB auxiliary files . Genome size correction is applied by rank based on default ranks only (superkingdom phylum class order family genus species assembly). Read counts in intermediate ranks will be corrected based on the closest parent default rank and re-assigned to its original rank. dist is the same of reads with read count re-distribution corr is the same of reads with correction by genome size matches will report the total number of matches classified, either unique or shared. This report will output the total number of matches instead the total number of reads reported in all other reports.","title":"report type (--report-type)"},{"location":"tutorials/","text":"Tutorials :) ... soon ...","title":"Tutorials"},{"location":"tutorials/#tutorials","text":"... soon ...","title":"Tutorials"}]}